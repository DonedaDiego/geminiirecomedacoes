<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, viewport-fit=cover">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Dashboard - Geminii Tech</title>
  <link rel="icon" type="image/png" sizes="32x32" href="assets/logo.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#6366f1',
            secondary: '#8b5cf6',
            accent: '#06b6d4',
            success: '#10b981',
            warning: '#f59e0b',
            danger: '#ef4444',
            geminii: '#fb1ebb'
          }
        }
      }
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    @keyframes spin {
      from { transform: rotate(0deg); }
      to   { transform: rotate(360deg); }
    }

    html, body {
      font-family: 'Inter', sans-serif;
      background: #050505;
      min-height: 100vh;
      width: 100%;
      overflow-x: hidden;
      margin: 0;
      padding: 0;
    }

    /* =============================================
       SIDEBAR — responsiva por breakpoint
    =============================================== */
    :root {
      --sidebar-width: 240px;
      --sidebar-collapsed: 64px;
    }

    .sidebar {
      background: #0a0a0a;
      border-right: 1px solid rgba(255, 255, 255, 0.07);
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      width: var(--sidebar-width);
      z-index: 40;
      overflow-y: auto;
      overflow-x: hidden;
      flex-shrink: 0;
      transition: width 0.3s ease, transform 0.3s ease;
    }

    .sidebar::-webkit-scrollbar { width: 4px; }
    .sidebar::-webkit-scrollbar-track { background: transparent; }
    .sidebar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 4px; }

    .sidebar-link {
      transition: all 0.2s ease;
      border-left: 3px solid transparent;
    }
    
    .sidebar-link:hover {
      background: rgba(255, 255, 255, 0.05);
      border-left-color: #6366f1;
    }
    
    .sidebar-link.active {
      background: rgba(99, 102, 241, 0.12);
      border-left-color: #6366f1;
      color: #6366f1;
    }

    /* =============================================
       MAIN CONTENT — acompanha sidebar
    =============================================== */
    .main-content {
      margin-left: var(--sidebar-width);
      min-height: 100vh;
      width: calc(100% - var(--sidebar-width));
      overflow-x: hidden;
      transition: margin-left 0.3s ease, width 0.3s ease;
    }

    /* =============================================
       BOTÃO HAMBURGER (mobile)
    =============================================== */
    .hamburger-btn {
      display: none;
      position: fixed;
      top: 14px;
      left: 14px;
      z-index: 50;
      background: rgba(20,20,25,0.95);
      border: 1px solid rgba(255,255,255,0.12);
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 10px;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      backdrop-filter: blur(10px);
    }

    /* Overlay para fechar sidebar no mobile */
    .sidebar-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      z-index: 39;
      backdrop-filter: blur(2px);
    }
    .sidebar-overlay.show { display: block; }

    /* =============================================
       BREAKPOINTS
    =============================================== */

    /* Monitores grandes (1440px+) — sidebar normal */
    @media (min-width: 1440px) {
      :root { --sidebar-width: 260px; }
      .main-content { padding-right: 8px; }
    }

    /* Monitores médios (1024px–1439px) — sidebar normal */
    @media (min-width: 1024px) and (max-width: 1439px) {
      :root { --sidebar-width: 240px; }
    }

    /* Tablets landscape / notebooks pequenos (768px–1023px) — sidebar recolhida com ícones */
    @media (min-width: 768px) and (max-width: 1023px) {
      :root { --sidebar-width: var(--sidebar-collapsed); }

      .sidebar { width: var(--sidebar-collapsed); overflow: hidden; }
      .sidebar:hover {
        width: 240px;
        box-shadow: 4px 0 24px rgba(0,0,0,0.6);
      }
      .sidebar:hover .sidebar-text,
      .sidebar:hover .sb-badge,
      .sidebar:hover .sidebar-logo-text { opacity: 1; width: auto; }

      /* Esconde textos quando recolhida */
      .sidebar-text,
      .sb-badge,
      .sidebar-logo-text {
        opacity: 0;
        width: 0;
        overflow: hidden;
        white-space: nowrap;
        transition: opacity 0.2s ease, width 0.2s ease;
      }
      /* Centraliza ícones */
      .sidebar nav a,
      .sidebar nav button {
        justify-content: center;
        padding-left: 0;
        padding-right: 0;
      }
      .sidebar:hover nav a,
      .sidebar:hover nav button {
        justify-content: flex-start;
        padding-left: 16px;
        padding-right: 16px;
      }
    }

    /* Mobile portrait / landscape pequeno (< 768px) */
    @media (max-width: 767px) {
      .hamburger-btn { display: flex; }

      .sidebar {
        width: 240px;
        transform: translateX(-100%);
      }
      .sidebar.open { transform: translateX(0); }

      .main-content {
        margin-left: 0;
        width: 100%;
        padding-top: 60px; /* espaço pro hamburger */
      }
    }

    /* Landscape em celular (altura < 500px) */
    @media (max-height: 500px) and (max-width: 900px) {
      .sidebar { font-size: 12px; }
      .sidebar nav { padding: 4px; }
      .sidebar-link { padding-top: 6px !important; padding-bottom: 6px !important; }
      .main-content { padding-top: 8px; }
    }
    
    .card {
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(255, 255, 255, 0.08);
      transition: all 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      border-color: rgba(255, 255, 255, 0.13);
    }
    
    .dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(20, 20, 25, 0.98); 
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.2); 
      border-radius: 16px;
      padding: 12px;
      margin-top: 8px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s ease;
      z-index: 1000;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.8); 
    }
    
    .dropdown.show {
      opacity: 1 !important;
      visibility: visible !important;
      transform: translateY(0) !important;
      display: block !important;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #6366f1, #8b5cf6);
      border: none;
      color: white;
      transition: all 0.3s ease;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);
    }
    
    .community-badge {
      background: linear-gradient(135deg, #fb1ebb, #6366f1);
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .free-badge {
      background: linear-gradient(135deg, #10b981, #06b6d4);
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .trial-badge {
      background: linear-gradient(135deg, #f59e0b, #ef4444);
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .tool-card {
      opacity: 1 !important;
      cursor: pointer !important;
      pointer-events: auto !important;
      position: relative;
      z-index: 10;
    }
    
    .dropdown a,
    .dropdown div {
      background-color: rgba(30, 30, 35, 0.6) !important;
      color: white !important;
    }

    .dropdown a:hover,
    .dropdown div:hover {
      background-color: rgba(50, 50, 60, 0.8) !important;
    }

    .coming-soon-card {
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 140, 0, 0.05));
      border: 2px solid rgba(255, 215, 0, 0.3);
      position: relative;
      overflow: hidden;
    }

    .coming-soon-card::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -100%;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, transparent, #ffd700, transparent);
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% { left: -100%; }
      100% { left: 100%; }
    }

    .coming-soon-badge {
      background: linear-gradient(135deg, #ffd700, #ff8c00);
      color: #000;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 10px;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      animation: pulse 2s infinite;
    }

    .notify-btn {
      background: linear-gradient(135deg, #10b981, #06b6d4);
      border: none;
      color: white;
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .notify-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
    }

    .netflix-container {
      position: relative;
      overflow: hidden;
    }

    .netflix-scroller {
      position: relative;
      display: flex;
      align-items: center;
    }

    .netflix-row {
      display: flex;
      gap: 8px;
      padding: 0 50px;
      overflow-x: auto;
      scroll-behavior: smooth;
      scrollbar-width: none;
      -ms-overflow-style: none;
      transition: transform 0.3s ease;
    }

    .netflix-row::-webkit-scrollbar {
      display: none;
    }

    .netflix-item {
      flex: 0 0 240px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      overflow: hidden;
      transition: all 0.3s ease;
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .netflix-item:hover {
      transform: scale(1.05) translateY(-8px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
      border-color: rgba(99, 102, 241, 0.3);
      z-index: 10;
    }

    .netflix-thumbnail {
      position: relative;
      width: 100%;
      height: 135px;
      overflow: hidden;
    }

    .netflix-thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .netflix-item:hover .netflix-thumbnail img {
      transform: scale(1.1);
    }

    .netflix-play-overlay {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 50px;
      height: 50px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: all 0.3s ease;
    }

    .netflix-item:hover .netflix-play-overlay {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1.1);
    }

    .netflix-play-overlay i {
      color: #000;
      font-size: 18px;
      margin-left: 3px;
    }

    .netflix-info {
      padding: 16px;
    }

    .netflix-info h4 {
      color: white;
      font-size: 14px;
      font-weight: 600;
      margin: 0 0 4px 0;
      line-height: 1.3;
    }

    .netflix-info p {
      color: #9ca3af;
      font-size: 12px;
      margin: 0;
      line-height: 1.4;
    }

    .netflix-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.7);
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 20;
      opacity: 0;
      transition: all 0.3s ease;
      font-size: 16px;
    }

    .netflix-container:hover .netflix-nav {
      opacity: 1;
    }

    .netflix-nav:hover {
      background: rgba(0, 0, 0, 0.9);
      transform: translateY(-50%) scale(1.1);
    }

    .netflix-nav-left {
      left: 10px;
    }

    .netflix-nav-right {
      right: 10px;
    }

    .social-item .netflix-thumbnail {
      height: 200px;
    }

    /* Netflix — mobile */
    @media (max-width: 767px) {
      .netflix-item { flex: 0 0 180px; }
      .netflix-thumbnail { height: 100px; }
      .netflix-row { padding: 0 20px; }
    }

    /* Sidebar accordion */
    .sb-submenu {
      overflow: hidden;
      transition: max-height 0.25s ease, opacity 0.25s ease;
    }
    .sb-submenu.open {
      display: block !important;
    }
    .sb-link {
      display: flex;
      transition: all 0.2s ease;
    }
    .sidebar-accordion > button.active-accordion {
      background: rgba(255,255,255,0.04);
      color: white;
    }
    .sb-chevron {
      transition: transform 0.25s ease;
    }
    .sb-chevron.rotated {
      transform: rotate(180deg);
    }

    .market-maker-btn {
      background: linear-gradient(135deg, rgba(234, 179, 8, 0.1) 0%, rgba(186, 57, 175, 0.1) 100%);
      border: 1px solid rgba(234, 179, 8, 0.3);
      position: relative;
    }

    .market-maker-btn:hover {
      background: linear-gradient(135deg, rgba(234, 179, 8, 0.2) 0%, rgba(186, 57, 175, 0.2) 100%);
      border-color: rgba(234, 179, 8, 0.5);
      transform: translateX(4px);
      box-shadow: 0 4px 12px rgba(234, 179, 8, 0.2);
    }

    .market-maker-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(234, 179, 8, 0.3), transparent);
      animation: shine 3s infinite;
    }

    @keyframes shine {
      0%, 100% {
        left: -100%;
      }
      50% {
        left: 100%;
      }
    }
  </style>
</head>
<body>
  
  <!-- Botão flutuante WhatsApp -->
  <a href="https://wa.me/5541995432873?text=Oi%2C%20preciso%20de%20suporte%20no%20app%20da%20Geminii%20Technology"
    target="_blank"
    id="whatsappFloat"
    title="Suporte via WhatsApp"
    style="
      position: fixed;
      bottom: 28px;
      right: 28px;
      z-index: 999;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: linear-gradient(135deg, #25d366, #128c7e);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(37,211,102,0.45);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      text-decoration: none;
    "
    onmouseover="this.style.transform='scale(1.12)';this.style.boxShadow='0 6px 28px rgba(37,211,102,0.6)'"
    onmouseout="this.style.transform='scale(1)';this.style.boxShadow='0 4px 20px rgba(37,211,102,0.45)'"
  >
    <i class="fab fa-whatsapp" style="color:white;font-size:1.6rem;"></i>

    <!-- Pulso animado -->
    <span style="
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: rgba(37,211,102,0.35);
      animation: waPulse 2s ease-out infinite;
      pointer-events: none;
    "></span>
  </a>

  <style>
    @keyframes waPulse {
      0%   { transform: scale(1);   opacity: 0.7; }
      70%  { transform: scale(1.6); opacity: 0;   }
      100% { transform: scale(1.6); opacity: 0;   }
    }
  </style>
  <button class="hamburger-btn" id="hamburgerBtn" onclick="toggleSidebar()" aria-label="Menu">
    <i class="fas fa-bars"></i>
  </button>

  <!-- Overlay mobile -->
  <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

  <!-- Sidebar -->
  <aside class="sidebar" id="mainSidebar">
    <div class="p-6 border-b border-white/10">
      <div class="flex items-center space-x-3">
        <img src="assets/logo.png" alt="Geminii Logo" class="w-8 h-8 rounded-lg flex-shrink-0" onerror="this.src='/assets/logo.png'; this.onerror=null;">
        <span class="text-xl font-bold text-white sidebar-text sidebar-logo-text">Geminii</span>
      </div>
    </div>
    
    <nav class="p-4 space-y-2">
      <a href="dashboard.html" class="sidebar-link active flex items-center space-x-3 px-4 py-3 rounded-lg text-white">
        <i class="fas fa-home w-5 flex-shrink-0"></i>
        <span class="font-medium sidebar-text">Dashboard</span>
      </a>
      
      <a href="recomendacoes-free.html" class="sidebar-link flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-400">
        <i class="fas fa-gift w-5 flex-shrink-0"></i>
        <span class="font-medium sidebar-text">Recomendações</span>
        <span class="ml-auto text-xs bg-green-500/20 text-green-400 px-2 py-0.5 rounded-full sb-badge sidebar-text">FREE</span>
      </a>

      <!-- AJUSTE 2: Tutoriais com href correto, livre para todos -->
      <a href="" class="sidebar-link flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-400">
        <i class="fas fa-graduation-cap w-5 text-yellow-400 flex-shrink-0"></i>
        <span class="font-medium sidebar-text">Tutoriais</span>
        <span class="ml-auto text-xs bg-green-500/20 text-yellow-400 px-2 py-0.5 rounded-full sb-badge sidebar-text">Breve</span>
      </a>
      
      <a href="https://www.youtube.com/@geminiiresearch?sub_confirmation=1" target="_blank" class="sidebar-link flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-400">
        <i class="fab fa-youtube w-5 text-red-500 flex-shrink-0"></i>
        <span class="font-medium sidebar-text">Canal YouTube</span>
      </a>

      <!-- Divisor -->
      <div class="border-t border-white/10 my-4"></div>
      <p class="text-xs text-gray-500 uppercase tracking-wider px-4 mb-2 sidebar-text">Ferramentas</p>

      <!-- Análise Essencial -->
      <div class="sidebar-accordion">
        <button onclick="toggleSidebarAccordion('sb-gratis')" class="sidebar-link w-full flex items-center justify-between px-4 py-3 rounded-lg text-gray-400">
          <div class="flex items-center space-x-3">
            <i class="fas fa-gift w-5 text-success flex-shrink-0"></i>
            <span class="font-medium text-sm sidebar-text">Análise Essencial</span>
          </div>
          <div class="flex items-center gap-2 sidebar-text">
            <span class="text-xs bg-success/20 text-success px-2 py-0.5 rounded-full sb-badge">FREE</span>
            <i class="fas fa-chevron-down text-gray-600 text-xs sb-chevron" id="chev-sb-gratis"></i>
          </div>
        </button>
        <div id="sb-gratis" class="sb-submenu hidden px-3 pb-1">
          <a href="monitor-basico.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-chart-area text-success text-xs w-4"></i>Monitor Beta
          </a>
          <!-- <a href="rsl.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-robot text-pink-400 text-xs w-4"></i>RSL Radar
          </a> -->
          <a href="amplitude.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-chart-bar text-orange-400 text-xs w-4"></i>Amplitude
          </a>
          <a href="rrg.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-robot text-pink-400 text-xs w-4"></i>RRG
          </a>
          <a href="sup_res_vol.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-chart-line text-blue-400 text-xs w-4"></i>Bandas Volatilidade
          </a>
        </div>
      </div>

      <!-- Monitor de Opções -->
      <div class="sidebar-accordion">
        <button onclick="toggleSidebarAccordion('sb-opcoes')" class="sidebar-link w-full flex items-center justify-between px-4 py-3 rounded-lg text-gray-400">
          <div class="flex items-center space-x-3">
            <i class="fas fa-chart-pie w-5 text-orange-400 flex-shrink-0"></i>
            <span class="font-medium text-sm sidebar-text">Monitor Opções</span>
          </div>
          <div class="flex items-center gap-2 sidebar-text">
            <span class="text-xs bg-orange-500/20 text-orange-400 px-2 py-0.5 rounded-full sb-badge">PRO</span>
            <i class="fas fa-chevron-down text-gray-600 text-xs sb-chevron" id="chev-sb-opcoes"></i>
          </div>
        </button>
        <div id="sb-opcoes" class="sb-submenu hidden px-3 pb-1">
          <a href="vi-pro.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-search text-purple-400 text-xs w-4"></i>Implícita Sigma
          </a>
          <a href="regimes-pro.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-chart-area text-purple-400 text-xs w-4"></i>Bandas Volatilidade
          </a>
          <a href="rank-volatilidade.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-search text-green-400 text-xs w-4"></i>IV Scanner
          </a>
          <a href="opcoes.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-crosshairs text-orange-400 text-xs w-4"></i>Hunter Walls
          </a>
        </div>
      </div>

      <!-- Machine Learning -->
      <div class="sidebar-accordion">
        <button onclick="toggleSidebarAccordion('sb-ml')" class="sidebar-link w-full flex items-center justify-between px-4 py-3 rounded-lg text-gray-400">
          <div class="flex items-center space-x-3">
            <i class="fas fa-brain w-5 text-purple-400 flex-shrink-0"></i>
            <span class="font-medium text-sm sidebar-text">Machine Learning</span>
          </div>
          <div class="flex items-center gap-2 sidebar-text">
            <span class="text-xs bg-purple-500/20 text-purple-400 px-2 py-0.5 rounded-full sb-badge">PRO</span>
            <i class="fas fa-chevron-down text-gray-600 text-xs sb-chevron" id="chev-sb-ml"></i>
          </div>
        </button>
        <div id="sb-ml" class="sb-submenu hidden px-3 pb-1">
          <a href="swing-trade-machine-learning.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-chart-line text-green-400 text-xs w-4"></i>Swing Trade ML
          </a>
          <a href="beta-regression.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-calculator text-blue-400 text-xs w-4"></i>Beta Regression
          </a>
          <a href="atsmom.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-rocket text-purple-400 text-xs w-4"></i>ATSMOM
          </a>
        </div>
      </div>

      <!-- Opções 4D -->
      <div class="sidebar-accordion">
        <button onclick="toggleSidebarAccordion('sb-4d')" class="sidebar-link w-full flex items-center justify-between px-4 py-3 rounded-lg text-gray-400">
          <div class="flex items-center space-x-3">
            <i class="fas fa-cube w-5 text-indigo-400 flex-shrink-0"></i>
            <span class="font-medium text-sm sidebar-text">Opções 4D</span>
          </div>
          <div class="flex items-center gap-2 sidebar-text">
            <span class="text-xs bg-indigo-500/20 text-indigo-400 px-2 py-0.5 rounded-full sb-badge">PRO</span>
            <i class="fas fa-chevron-down text-gray-600 text-xs sb-chevron" id="chev-sb-4d"></i>
          </div>
        </button>
        <div id="sb-4d" class="sb-submenu hidden px-3 pb-1">
          <a href="gamma-levels.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-layer-group text-purple-400 text-xs w-4"></i>GEX - Gamma
          </a>
          <a href="delta-levels.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-layer-group text-purple-400 text-xs w-4"></i>DEX - Delta
          </a>
          <a href="vega-levels.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-layer-group text-purple-400 text-xs w-4"></i>VEX - Vega
          </a>
          <a href="theta-levels.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-layer-group text-purple-400 text-xs w-4"></i>TEX - Theta
          </a>
          <a href="historical-levels.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-history text-indigo-400 text-xs w-4"></i>Análise Histórica
          </a>
        </div>
      </div>

      <!-- Rastreamento -->
      <div class="sidebar-accordion">
        <button onclick="toggleSidebarAccordion('sb-rastr')" class="sidebar-link w-full flex items-center justify-between px-4 py-3 rounded-lg text-gray-400">
          <div class="flex items-center space-x-3">
            <i class="fas fa-search-plus w-5 text-cyan-400 flex-shrink-0"></i>
            <span class="font-medium text-sm sidebar-text">Rastreamento</span>
          </div>
          <div class="flex items-center gap-2 sidebar-text">
            <span class="text-xs bg-cyan-500/20 text-cyan-400 px-2 py-0.5 rounded-full sb-badge">PRO</span>
            <i class="fas fa-chevron-down text-gray-600 text-xs sb-chevron" id="chev-sb-rastr"></i>
          </div>
        </button>
        <div id="sb-rastr" class="sb-submenu hidden px-3 pb-1">
          <a href="greeks-micro.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-layer-group text-cyan-400 text-xs w-4"></i>Visão Global
          </a>
          <a href="screening.html" class="sb-link flex items-center gap-3 px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-all text-sm">
            <i class="fas fa-search text-cyan-400 text-xs w-4"></i>Gamma Flip Screening
          </a>
        </div>
      </div>

    </nav>

    <!-- Status + Sair integrados -->
    <div class="border-t border-white/10 mx-4 mt-2"></div>
    <div class="flex items-center justify-between px-6 py-4">
      <div id="statusIndicator" class="flex items-center space-x-2">
        <div class="w-2 h-2 bg-success rounded-full animate-pulse"></div>
        <span class="text-xs text-gray-400">Online</span>
      </div>
      <button onclick="logout()" class="flex items-center gap-2 text-xs text-red-400 hover:text-red-300 transition-colors">
        <i class="fas fa-sign-out-alt"></i>Sair
      </button>
    </div>
    
  </aside>

  <!-- Main Content -->
  <main class="main-content px-6 py-8">
    <div class="w-full max-w-screen-2xl mx-auto">

      <!-- Header Section — repaginado -->
      <div class="card rounded-2xl mb-6 overflow-hidden" style="background: rgba(255,255,255,0.04)">

        <!-- Faixa gradiente decorativa no topo -->
        <div style="height: 4px; background: linear-gradient(90deg, #6366f1, #fb1ebb, #06b6d4);"></div>

        <div class="p-8">
          <div class="flex flex-col lg:flex-row items-center lg:items-start gap-6">

            <!-- Avatar com anel gradiente animado -->
            <div class="flex-shrink-0 relative">
              <div style="
                width: 88px; height: 88px; border-radius: 50%;
                background: linear-gradient(135deg, #6366f1, #fb1ebb, #06b6d4);
                padding: 3px;
                animation: spin 6s linear infinite;
              ">
                <div id="userAvatar" style="width:100%; height:100%; border-radius:50%; background:#111;"
                  class="flex items-center justify-center text-white text-2xl font-bold">
                  <span id="userInitials">U</span>
                </div>
              </div>
              <!-- Ponto online -->
              <div style="position:absolute; bottom:4px; right:4px; width:14px; height:14px;
                background:#10b981; border-radius:50%; border: 2px solid #111;"></div>
            </div>

            <!-- Info principal -->
            <div class="flex-1 text-center lg:text-left">

              <!-- Saudação dinâmica -->
              <p class="text-sm text-gray-500 mb-1" id="greetingText">Bom dia</p>

              <h1 class="text-3xl font-bold text-white mb-3 leading-tight">
                <span id="userName" class="gradient-text">Usuário</span>
              </h1>

              <p class="text-gray-400 text-sm mb-4" id="userEmail">—</p>

              <!-- Badges de plano + membro desde -->
              <div class="flex flex-wrap justify-center lg:justify-start items-center gap-3 mb-5">
                <span id="userPlanBadge" class="free-badge">
                  <i class="fas fa-user"></i>Plano Free
                </span>
                <div class="flex items-center gap-1 text-xs text-gray-500 bg-white/5 px-3 py-1.5 rounded-full">
                  <i class="fas fa-calendar-alt text-gray-600"></i>
                  <span>Membro desde <span id="memberSince" class="text-gray-300 font-medium">2025</span></span>
                </div>
                <div id="trialInfo" class="hidden flex items-center gap-1 text-xs text-warning bg-warning/10 px-3 py-1.5 rounded-full">
                  <i class="fas fa-clock"></i>
                  <span>Trial: <span id="trialDaysLeft">--</span> dias restantes</span>
                </div>
              </div>

              <!-- Redes sociais compactas e coloridas -->
              <div class="flex flex-wrap justify-center lg:justify-start gap-2">
                <a href="https://discord.gg/zMmcg4Ja" target="_blank"
                  class="flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-all hover:scale-105"
                  style="background:rgba(88,101,242,0.15); color:#7289da; border:1px solid rgba(88,101,242,0.25);">
                  <i class="fab fa-discord"></i>Discord
                </a>
                <a href="https://instagram.com/geminiiresearch" target="_blank"
                  class="flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-all hover:scale-105"
                  style="background:rgba(225,48,108,0.12); color:#e1306c; border:1px solid rgba(225,48,108,0.25);">
                  <i class="fab fa-instagram"></i>Instagram
                </a>
                <a href="https://linkedin.com/company/geminii-research" target="_blank"
                  class="flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-all hover:scale-105"
                  style="background:rgba(10,102,194,0.15); color:#0a66c2; border:1px solid rgba(10,102,194,0.3);">
                  <i class="fab fa-linkedin"></i>LinkedIn
                </a>
                <a href="https://x.com/geminiiresearch" target="_blank"
                  class="flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-all hover:scale-105"
                  style="background:rgba(255,255,255,0.06); color:#e7e9ea; border:1px solid rgba(255,255,255,0.12);">
                  <i class="fab fa-x-twitter"></i>X
                </a>
              </div>
            </div>

            <!-- Botão upgrade (mantido, oculto por padrão) -->
            <div class="flex-shrink-0">
              <a href="planos.html" id="upgradeBtn"
                class="hidden bg-gradient-to-r from-warning to-danger text-white px-5 py-3 rounded-xl font-semibold text-sm inline-flex items-center gap-2 hover:opacity-90 transition-all">
                <i class="fas fa-crown"></i>Upgrade para Comunidade
              </a>
            </div>

          </div>
        </div>
      </div>

      <!-- Carousel — Mentoria Opções -->
      <div class="mb-8 relative overflow-hidden rounded-2xl" id="mentoriaCarousel" style="cursor:pointer;" onclick="window.open('https://www.geminii.com.br', '_blank')">

        <!-- Slides -->
        <div id="carouselTrack" style="display:flex; transition: transform 0.6s cubic-bezier(0.4,0,0.2,1); will-change: transform;">

          <!-- Slide 1 — Mentoria Opções -->
          <div class="carousel-slide flex-shrink-0 w-full" style="
            min-width: 100%;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a0a2e 40%, #0d1a3a 100%);
            border: 1px solid rgba(99,102,241,0.2);
            padding: 32px 40px;
            position: relative; overflow: hidden;
          ">
            <!-- Orbs decorativos -->
            <div style="position:absolute;top:-40px;right:-40px;width:220px;height:220px;border-radius:50%;background:radial-gradient(circle, rgba(251,30,187,0.18) 0%, transparent 70%);pointer-events:none;"></div>
            <div style="position:absolute;bottom:-60px;left:60px;width:180px;height:180px;border-radius:50%;background:radial-gradient(circle, rgba(99,102,241,0.15) 0%, transparent 70%);pointer-events:none;"></div>

            <div class="flex flex-col lg:flex-row gap-8 relative z-10">

              <!-- Coluna esquerda — título + preço + CTA -->
              <div style="flex:0 0 auto; min-width:220px; max-width:260px;" class="flex flex-col justify-between">
                <div>
                  <div class="flex flex-wrap items-center gap-2 mb-4">
                    <span style="background:rgba(251,30,187,0.15);color:#fb1ebb;border:1px solid rgba(251,30,187,0.3);padding:4px 12px;border-radius:999px;font-size:11px;font-weight:600;letter-spacing:0.05em;">MENTORIA AO VIVO</span>                    
                  </div>
                  <h2 style="color:white;font-size:1.6rem;font-weight:800;line-height:1.2;margin-bottom:8px;">
                    Comunidade de<br>
                    <span style="background:linear-gradient(90deg,#fb1ebb);-webkit-background-clip:text;-webkit-text-fill-color:transparent;">Opções</span>
                  </h2>
                  <p style="color:#6b7280;font-size:0.78rem;line-height:1.5;margin-bottom:20px;">
                    Encontros online, onde são passadas as recomendações das entruturas 
                  </p>
                </div>
                <div>
                  <div style="display:flex;align-items:baseline;gap:4px;margin-bottom:4px;">
                    <span style="color:#fb1ebb;font-size:2.2rem;font-weight:800;line-height:1;">R$199</span>
                    <span style="color:#6b7280;font-size:0.78rem;">/mês</span>
                  </div>
                  <div style="color:#6b7280;font-size:0.72rem;margin-bottom:14px;">
                    ou R$1.600/ano &nbsp;·&nbsp; <span style="color:#10b981;">sem fidelidade</span>
                  </div>
                  <a href="https://geminii.com.br/comunidade-opcoes/" target="_blank" onclick="event.stopPropagation()"
                    style="background:linear-gradient(90deg,#f311f3,#f311f3);color:white;padding:11px 22px;border-radius:10px;font-weight:700;font-size:0.85rem;display:inline-block;text-decoration:none;white-space:nowrap;">
                    Quero participar →
                  </a>
                </div>  
              </div>

              <!-- Divisor vertical -->
              <div style="width:1px;background:rgba(255,255,255,0.07);flex-shrink:0;" class="hidden lg:block"></div>

              <!-- Coluna direita — benefícios em grid -->
              <div style="flex:1;display:grid;grid-template-columns:repeat(2,1fr);gap:10px;align-content:start;">

                <div style="background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:10px;padding:12px 14px;display:flex;align-items:flex-start;gap:10px;">
                  <i class="fab fa-whatsapp" style="color:#25d366;font-size:1.1rem;margin-top:2px;flex-shrink:0;"></i>
                  <div>
                    <div style="color:white;font-size:0.8rem;font-weight:600;margin-bottom:2px;">Grupo WhatsApp Exclusivo</div>
                    <div style="color:#6b7280;font-size:0.72rem;line-height:1.4;">Focado em opções, sem ruído. Comunicação direta.</div>
                  </div>
                </div>

                <div style="background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:10px;padding:12px 14px;display:flex;align-items:flex-start;gap:10px;">
                  <i class="fas fa-video" style="color:#6366f1;font-size:1.1rem;margin-top:2px;flex-shrink:0;"></i>
                  <div>
                    <div style="color:white;font-size:0.8rem;font-weight:600;margin-bottom:2px;">Mentorias ao Vivo 2x/semana</div>
                    <div style="color:#6b7280;font-size:0.72rem;line-height:1.4;">Com analista CNPI. Todos os encontros gravados.</div>
                  </div>
                </div>

                <div style="background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:10px;padding:12px 14px;display:flex;align-items:flex-start;gap:10px;">
                  <i class="fas fa-graduation-cap" style="color:#f59e0b;font-size:1.1rem;margin-top:2px;flex-shrink:0;"></i>
                  <div>
                    <div style="color:white;font-size:0.8rem;font-weight:600;margin-bottom:2px;">Aulas Gravadas de Nivelamento</div>
                    <div style="color:#6b7280;font-size:0.72rem;line-height:1.4;">Do básico ao avançado, no seu ritmo e todos os encontros são gravados.</div>
                  </div>
                </div>

                <div style="background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:10px;padding:12px 14px;display:flex;align-items:flex-start;gap:10px;">
                  <i class="fas fa-shield-alt" style="color:#10b981;font-size:1.1rem;margin-top:2px;flex-shrink:0;"></i>
                  <div>
                    <div style="color:white;font-size:0.8rem;font-weight:600;margin-bottom:2px;">Estratégias Zero Risco</div>
                    <div style="color:#6b7280;font-size:0.72rem;line-height:1.4;">Estruturas com foco em acumulo de patrimônio.</div>
                  </div>
                </div>

                <div style="background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:10px;padding:12px 14px;display:flex;align-items:flex-start;gap:10px;">
                  <i class="fas fa-chart-bar" style="color:#fb1ebb;font-size:1.1rem;margin-top:2px;flex-shrink:0;"></i>
                  <div>
                    <div style="color:white;font-size:0.8rem;font-weight:600;margin-bottom:2px;">Indicadores no Profit</div>
                    <div style="color:#6b7280;font-size:0.72rem;line-height:1.4;">Ferramentas geradas em python</div>
                  </div>
                </div>

                <div style="background:rgba(99,102,241,0.08);border:1px solid rgba(99,102,241,0.2);border-radius:10px;padding:12px 14px;display:flex;align-items:flex-start;gap:10px;">
                  <i class="fas fa-mobile-alt" style="color:#6366f1;font-size:1.1rem;margin-top:2px;flex-shrink:0;"></i>
                  <div>
                    <div style="color:white;font-size:0.8rem;font-weight:600;margin-bottom:2px;">App Geminii Technology Completo</div>
                    <div style="color:#6b7280;font-size:0.72rem;line-height:1.4;">Regime de mercado, vol e posicionamento em opções.</div>
                  </div>
                </div>

              </div>
            </div>
          </div>

          <!-- Slide 2 — Geminii Research -->
          <div class="carousel-slide flex-shrink-0 w-full" style="
            min-width: 100%;
            background: linear-gradient(135deg, #050510 0%, #0a1628 50%, #050d1a 100%);
            border: 1px solid rgba(6,182,212,0.2);
            padding: 32px 40px;
            position: relative; overflow: hidden;
          ">
            <div style="position:absolute;top:-30px;right:20px;width:200px;height:200px;border-radius:50%;background:radial-gradient(circle,rgba(6,182,212,0.12) 0%,transparent 70%);pointer-events:none;"></div>
            <div style="position:absolute;bottom:-50px;left:30px;width:150px;height:150px;border-radius:50%;background:radial-gradient(circle,rgba(99,102,241,0.1) 0%,transparent 70%);pointer-events:none;"></div>

            <div class="flex flex-col lg:flex-row gap-8 relative z-10">

              <!-- Coluna esquerda — identidade + descrição -->
              <div style="flex:0 0 auto; min-width:220px; max-width:280px;" class="flex flex-col justify-between">
                <div>
                  <div class="flex items-center gap-2 mb-4">
                    <span style="background:rgba(6,182,212,0.12);color:#06b6d4;border:1px solid rgba(6,182,212,0.25);padding:4px 12px;border-radius:999px;font-size:11px;font-weight:600;letter-spacing:0.05em;">RESEARCH QUANTITATIVA</span>
                  </div>
                  <h2 style="color:white;font-size:1.6rem;font-weight:800;line-height:1.2;margin-bottom:10px;">
                    GEMINII<br>
                    <span style="background:linear-gradient(90deg,#F311F3);-webkit-background-clip:text;-webkit-text-fill-color:transparent;">RESEARCH</span>
                  </h2>
                  <p style="color:#9ca3af;font-size:0.78rem;line-height:1.6;margin-bottom:16px;">
                    Casa de análises quantitativas independente. Transforma dados e estatística em decisões objetivas de investimento sem conflito com instituições financeiras.
                  </p>
                  <div>                    
                  </div>
                </div>
                <a href="https://www.geminii.com.br" target="_blank" onclick="event.stopPropagation()"
                  style="background:linear-gradient(90deg,#f311f3,#f311f3);color:white;padding:11px 22px;border-radius:10px;font-weight:700;font-size:0.85rem;display:inline-block;text-decoration:none;white-space:nowrap;">
                  Conhecer o site →
                </a>
              </div>

              <!-- Divisor vertical -->
              <div style="width:1px;background:rgba(255,255,255,0.07);flex-shrink:0;" class="hidden lg:block"></div>

              <!-- Coluna direita — diferenciais em grid -->
              <div style="flex:1;display:grid;grid-template-columns:repeat(2,1fr);gap:10px;align-content:start;">

                <div style="background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:10px;padding:12px 14px;display:flex;align-items:flex-start;gap:10px;">
                  <i class="fas fa-brain" style="color:#6366f1;font-size:1.1rem;margin-top:2px;flex-shrink:0;"></i>
                  <div>
                    <div style="color:white;font-size:0.8rem;font-weight:600;margin-bottom:2px;">Modelos Matemáticos</div>
                    <div style="color:#6b7280;font-size:0.72rem;line-height:1.4;">Estratégias sistemáticas baseadas em probabilidade e precificação.</div>
                  </div>
                </div>

                <div style="background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:10px;padding:12px 14px;display:flex;align-items:flex-start;gap:10px;">
                  <i class="fas fa-wave-square" style="color:#06b6d4;font-size:1.1rem;margin-top:2px;flex-shrink:0;"></i>
                  <div>
                    <div style="color:white;font-size:0.8rem;font-weight:600;margin-bottom:2px;">Análise de Volatilidade</div>
                    <div style="color:#6b7280;font-size:0.72rem;line-height:1.4;">Modelos GARCH, vol implícita e regime de mercado em tempo real.</div>
                  </div>
                </div>

                <div style="background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:10px;padding:12px 14px;display:flex;align-items:flex-start;gap:10px;">
                  <i class="fas fa-layer-group" style="color:#fb1ebb;font-size:1.1rem;margin-top:2px;flex-shrink:0;"></i>
                  <div>
                    <div style="color:white;font-size:0.8rem;font-weight:600;margin-bottom:2px;">Estruturas com Derivativos</div>
                    <div style="color:#6b7280;font-size:0.72rem;line-height:1.4;">Greeks, collar, box e operações com foco em proteção de capital.</div>
                  </div>
                </div>

                <div style="background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:10px;padding:12px 14px;display:flex;align-items:flex-start;gap:10px;">
                  <i class="fas fa-shield-alt" style="color:#10b981;font-size:1.1rem;margin-top:2px;flex-shrink:0;"></i>
                  <div>
                    <div style="color:white;font-size:0.8rem;font-weight:600;margin-bottom:2px;">Copy Trade</div>
                    <div style="color:#6b7280;font-size:0.72rem;line-height:1.4;">Copy trade de futuros via nelogica.</div>
                  </div>
                </div>

                <div style="background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);border-radius:10px;padding:12px 14px;display:flex;align-items:flex-start;gap:10px;">
                  <i class="fas fa-chart-line" style="color:#f59e0b;font-size:1.1rem;margin-top:2px;flex-shrink:0;"></i>
                  <div>
                    <div style="color:white;font-size:0.8rem;font-weight:600;margin-bottom:2px;">Portfólios Inteligentes</div>
                    <div style="color:#6b7280;font-size:0.72rem;line-height:1.4;">Smart Blue Chips, Small Caps, Growth e BDRs — +38% em 2025.</div>
                  </div>
                </div>

                <div style="background:rgba(6,182,212,0.06);border:1px solid rgba(6,182,212,0.2);border-radius:10px;padding:12px 14px;display:flex;align-items:flex-start;gap:10px;">
                  <i class="fas fa-ban" style="color:#06b6d4;font-size:1.1rem;margin-top:2px;flex-shrink:0;"></i>
                  <div>
                    <div style="color:white;font-size:0.8rem;font-weight:600;margin-bottom:2px;">Zero Conflito de Interesse</div>
                    <div style="color:#6b7280;font-size:0.72rem;line-height:1.4;">Independente de bancos e corretoras. Só o seu capital importa.</div>
                  </div>
                </div>

              </div>
            </div>
          </div>

        </div>

        <!-- Dots indicadores -->
        <div style="position:absolute;bottom:14px;left:50%;transform:translateX(-50%);display:flex;gap:6px;z-index:10;">
          <div class="carousel-dot active" data-index="0" onclick="event.stopPropagation();goToSlide(0)"
            style="width:8px;height:8px;border-radius:999px;background:#fb1ebb;transition:all 0.3s;cursor:pointer;"></div>
          <div class="carousel-dot" data-index="1" onclick="event.stopPropagation();goToSlide(1)"
            style="width:8px;height:8px;border-radius:999px;background:rgba(255,255,255,0.25);transition:all 0.3s;cursor:pointer;"></div>
        </div>

        <!-- Setas nav -->
        <button onclick="event.stopPropagation();prevSlide()" style="position:absolute;left:12px;top:50%;transform:translateY(-50%);background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.1);color:white;width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10;font-size:13px;backdrop-filter:blur(4px);">
          <i class="fas fa-chevron-left"></i>
        </button>
        <button onclick="event.stopPropagation();nextSlide()" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.1);color:white;width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10;font-size:13px;backdrop-filter:blur(4px);">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>

      <!-- Recommendations Free Card -->
      <div class="card rounded-2xl p-8 mb-8">
        <div class="flex items-center justify-between mb-6">
          <div>
            <h2 class="text-2xl font-bold text-white mb-2 flex items-center">              
              Recomendações Gratuitas
            </h2>
            <p class="text-gray-300">Análises mensais disponíveis para todos os usuários</p>
          </div>
          <a href="recomendacoes-free.html" class="btn-primary px-6 py-3 rounded-xl font-semibold inline-flex items-center">
            <i class="fas fa-chart-line mr-2"></i>
            Ver Recomendações
          </a>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div class="bg-white/5 rounded-lg p-4">
            <div class="flex items-center justify-between mb-2">
              <span class="text-gray-400">Sinais Ativos</span>
              <i class="fas fa-signal text-accent"></i>
            </div>
            <div class="text-2xl font-bold text-white" id="activeSignalsCount">--</div>
            <div class="text-sm text-gray-400">Recomendações em andamento</div>
          </div>
          
          <div class="bg-white/5 rounded-lg p-4">
            <div class="flex items-center justify-between mb-2">
              <span class="text-gray-400">Taxa de Acerto</span>
              <i class="fas fa-bullseye text-success"></i>
            </div>
            <div class="text-2xl font-bold text-success" id="freeSuccessRate">--</div>
            <div class="text-sm text-gray-400">Últimos 90 dias</div>
          </div>
          
          <div class="bg-white/5 rounded-lg p-4">
            <div class="flex items-center justify-between mb-2">
              <span class="text-gray-400">Ativo Recomendado</span>
              <i class="fas fa-crosshairs text-geminii"></i>
            </div>
            <div class="text-2xl font-bold text-white" id="activeTickerName">--</div>
            <div class="text-sm text-gray-400 truncate" id="activeTickerCompany">Última recomendação ativa</div>
          </div>
        </div>
      </div>

      <!-- Market Radar Section — TradingView -->
      <div class="card rounded-2xl p-6 mb-8">
        <div class="flex items-center justify-between mb-5">
          <div>
            <h2 class="text-2xl font-bold text-white mb-1 flex items-center">
              <i class="fas fa-chart-candlestick text-accent mr-3"></i>
              Radar de Mercado
            </h2>
            <p class="text-gray-300 text-sm">Gráfico e Cotações Globais</p>
          </div>
          <div class="flex items-center gap-2">
            <div class="w-2 h-2 bg-success rounded-full animate-pulse"></div>
            <span class="text-sm text-gray-400">TradingView Live</span>
          </div>
        </div>

        <!-- Dois widgets lado a lado, responsivos -->
        <div style="display: flex; gap: 16px; width: 100%; align-items: stretch; flex-wrap: wrap;">

          <!-- Gráfico BOVA11 — ocupa ~65% da largura -->
          <div style="flex: 65 1 400px; min-width: 300px; height: 520px; border-radius: 12px; overflow: hidden; background: #0F0F0F;">
            <div class="tradingview-widget-container" style="height: 100%; width: 100%;">
              <div class="tradingview-widget-container__widget" style="height: calc(100% - 32px); width: 100%;"></div>
              <div class="tradingview-widget-copyright">
                <a href="https://br.tradingview.com/symbols/BMFBOVESPA-BOVA11/" rel="noopener nofollow" target="_blank">
                  <span class="blue-text" style="color:#888; font-size:11px;"></span>
                </a>
              </div>
              <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js" async>
              {
                "allow_symbol_change": true,
                "calendar": false,
                "details": false,
                "hide_side_toolbar": true,
                "hide_top_toolbar": false,
                "hide_legend": false,
                "hide_volume": false,
                "hotlist": false,
                "interval": "D",
                "locale": "br",
                "save_image": true,
                "style": "1",
                "symbol": "AMEX:EWZ",
                "theme": "dark",
                "timezone": "Etc/UTC",
                "backgroundColor": "#0F0F0F",
                "gridColor": "rgba(242, 242, 242, 0.06)",
                "watchlist": [],
                "withdateranges": false,
                "compareSymbols": [],
                "studies": [],
                "autosize": true
              }
              </script>
            </div>
          </div>

          <!-- Market Quotes — ocupa ~35% da largura -->
          <div style="flex: 35 1 280px; min-width: 280px; height: 520px; border-radius: 12px; overflow: hidden; background: #0F0F0F;">
            <div class="tradingview-widget-container" style="height: 100%; width: 100%;">
              <div class="tradingview-widget-container__widget" style="height: calc(100% - 32px); width: 100%;"></div>
              <div class="tradingview-widget-copyright">
                <a href="https://www.tradingview.com/markets/" rel="noopener nofollow" target="_blank">
                  <span class="blue-text" style="color:#888; font-size:11px;"></span>
                </a>
              </div>
              <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-quotes.js" async>
              {
                "colorTheme": "dark",
                "locale": "br",
                "largeChartUrl": "",
                "isTransparent": true,
                "showSymbolLogo": true,
                "backgroundColor": "#0F0F0F",
                "support_host": "https://www.tradingview.com",
                "width": "100%",
                "height": "100%",
                "autosize": true,
                "symbolsGroups": [
                  {
                    "name": "Índices",
                    "symbols": [
                      { "name": "FOREXCOM:SPXUSD",   "displayName": "S&P 500" },
                      { "name": "FOREXCOM:NSXUSD",   "displayName": "Nasdaq 100" },
                      { "name": "FOREXCOM:DJI",       "displayName": "Dow Jones" },
                      { "name": "INDEX:NKY",          "displayName": "Japan 225" },
                      { "name": "INDEX:DEU40",        "displayName": "DAX" },
                      { "name": "FOREXCOM:UKXGBP",   "displayName": "FTSE 100" }
                    ]
                  },
                  {
                    "name": "ADRs Brasil",
                    "symbols": [
                      { "name": "NYSE:VALE",   "displayName": "VALE" },
                      { "name": "NYSE:PBR",    "displayName": "PETR" },
                      { "name": "AMEX:EWZ",    "displayName": "IBOV ETF" },
                      { "name": "NYSE:ITUB",   "displayName": "ITUB" },
                      { "name": "NYSE:BBD",    "displayName": "BBDC" }
                    ]
                  },
                  {
                    "name": "Forex",
                    "symbols": [
                      { "name": "FX:EURUSD",  "displayName": "EUR/USD" },
                      { "name": "FX:GBPUSD",  "displayName": "GBP/USD" },
                      { "name": "FX:USDJPY",  "displayName": "USD/JPY" },
                      { "name": "FX:USDCHF",  "displayName": "USD/CHF" },
                      { "name": "FX:AUDUSD",  "displayName": "AUD/USD" },
                      { "name": "FX:USDCAD",  "displayName": "USD/CAD" }
                    ]
                  }
                ]
              }
              </script>
            </div>
          </div>

        </div>
      </div>               
    </div>
  </main>

  <script>
    let currentUser = null;
    let userToken = null;
    let userPlan = 'trial';

    async function initDashboard() {
      console.log('Inicializando Dashboard Geminii...');
      
      tryLoadFromLocalStorage();
      await checkAuth();
      await loadFreeRecommendationsStatsWithRetry();
      checkApiStatus();
      setInterval(checkApiStatus, 30000);                
      console.log('✅ Dashboard inicializado!');
    }

    function tryLoadFromLocalStorage() {
      try {
        const userData = localStorage.getItem('geminii_user');
        if (userData) {
          const user = JSON.parse(userData);
          if (user && user.name) {
            console.log('📦 Carregando dados do localStorage:', user.name);
            updateUserInterface(user);
          }
        }
      } catch (error) {
        console.log('⚠️ Erro no localStorage:', error);
      }
    }

    function checkUserPlan(user) {
      console.log('🔍 Verificando plano do usuário:', user);
      console.log('📊 user_type:', user.user_type, 'plan_id:', user.plan_id);
      
      if (user.user_type === 'admin') {
        console.log('👑 ADMIN DETECTADO - ACESSO TOTAL');
        userPlan = 'admin';
        return 'admin';
      }
      
      if (user.user_type === 'paid') {
        console.log('💰 PAID DETECTADO - ACESSO TOTAL');
        userPlan = 'paid';
        return 'paid';
      }
      
      if (user.user_type === 'trial') {
        console.log('⏰ TRIAL DETECTADO - ACESSO TOTAL');
        userPlan = 'trial';
        return 'trial';
      }
      
      if (user.user_type === 'regular') {
        console.log('🆓 REGULAR DETECTADO - ACESSO LIMITADO');
        userPlan = 'free';
        return 'free';
      }
      
      console.log('⚠️ USER_TYPE NÃO IDENTIFICADO - DEFAULTING PARA FREE');
      userPlan = 'free';
      return 'free';
    }

    function applyAccessControls() {
      console.log('🔒 Aplicando controles de acesso para user_type:', userPlan);

      const opcoesCard  = document.querySelector('[onclick="toggleSidebarAccordion(\'sb-opcoes\')"]')?.closest('.sidebar-accordion');
      const mlCard      = document.querySelector('[onclick="toggleSidebarAccordion(\'sb-ml\')"]')?.closest('.sidebar-accordion');
      const opcoes4dCard = document.querySelector('[onclick="toggleSidebarAccordion(\'sb-4d\')"]')?.closest('.sidebar-accordion');
      const rastreamentoCard = document.querySelector('[onclick="toggleSidebarAccordion(\'sb-rastr\')"]')?.closest('.sidebar-accordion');

      if (userPlan === 'free') {
        console.log('🚫 BLOQUEANDO ACESSO - USUÁRIO REGULAR');

        [opcoesCard, mlCard, opcoes4dCard, rastreamentoCard].forEach(card => {
          if (card) {
            card.style.opacity = '0.5';
            card.style.cursor = 'not-allowed';
            card.style.pointerEvents = 'none';

            if (!card.querySelector('.access-overlay')) {
              const overlay = document.createElement('div');
              overlay.className = 'access-overlay';
              overlay.style.cssText = `
                position: absolute;
                top: 8px;
                right: 8px;
                background: rgba(0,0,0,0.7);
                border: 1px solid rgba(234,179,8,0.3);
                border-radius: 8px;
                padding: 4px 8px;
                display: flex;
                align-items: center;
                gap: 6px;
                z-index: 20;
                cursor: pointer;
              `;
              overlay.innerHTML = `
                <i class="fas fa-lock" style="color:#facc15; font-size:11px;"></i>
                <span style="color:#facc15; font-size:11px; font-weight:600;">PRO</span>
              `;
              overlay.onclick = () => window.open('planos.html', '_blank');
              card.style.position = 'relative';
              card.appendChild(overlay);
            }
          }
        });

      } else {
        console.log('✅ LIBERANDO ACESSO TOTAL para user_type:', userPlan);

        [opcoesCard, mlCard, opcoes4dCard, rastreamentoCard].forEach(card => {
          if (card) {
            card.style.opacity = '1';
            card.style.cursor = 'pointer';
            card.style.pointerEvents = 'auto';

            const overlay = card.querySelector('.access-overlay');
            if (overlay) overlay.remove();
          }
        });
      }
    }

    function configurarLinksPlanos() {
      const links = {
        carteira: 'https://geminii.com.br/assinaturas/',
        swingTrade: 'https://geminii.com.br/swing-position/', 
        positionTrade: 'https://geminii.com.br/st-opcoes/',
        consultoria: 'https://geminii.com.br/consultoria/',
        saibaMais: 'https://geminii.com.br/',
      };

      if (document.getElementById('carteiraLink')) document.getElementById('carteiraLink').href = links.carteira;
      if (document.getElementById('swingTradeLink')) document.getElementById('swingTradeLink').href = links.swingTrade;
      if (document.getElementById('positionTradeLink')) document.getElementById('positionTradeLink').href = links.positionTrade;
      if (document.getElementById('consultoriaLink')) document.getElementById('consultoriaLink').href = links.consultoria;
      if (document.getElementById('saibaMaisLink')) document.getElementById('saibaMaisLink').href = links.saibaMais;
    }

    document.addEventListener('DOMContentLoaded', () => {
      configurarLinksPlanos();
      initDashboard();
    });

    function updatePlanInterface(plan, user = null) {
      const planBadge = document.getElementById('userPlanBadge');
      const upgradeBtn = document.getElementById('upgradeBtn');
      const trialInfo = document.getElementById('trialInfo');
      const trialDaysLeft = document.getElementById('trialDaysLeft');
      
      if (plan === 'admin') {
        planBadge.className = 'community-badge';
        planBadge.innerHTML = '<i class="fas fa-crown"></i>Administrador';
        upgradeBtn.classList.add('hidden');
        trialInfo.classList.add('hidden');
      } else if (plan === 'paid') {
        planBadge.className = 'community-badge';
        planBadge.innerHTML = '<i class="fas fa-star"></i>Comunidade';
        upgradeBtn.classList.add('hidden');
        trialInfo.classList.add('hidden');
      } else if (plan === 'trial') {
        planBadge.className = 'trial-badge';
        planBadge.innerHTML = '<i class="fas fa-clock"></i>Trial Ativo';
        upgradeBtn.classList.remove('hidden');
        trialInfo.classList.remove('hidden');
        
        let daysLeft = 0;
        
        if (user && user.plan_expires_at) {
          const now = new Date();
          const expiresAt = new Date(user.plan_expires_at);
          const diffMs = expiresAt - now;
          daysLeft = Math.ceil(diffMs / (1000 * 60 * 60 * 24));
        }
        
        trialDaysLeft.textContent = Math.max(0, daysLeft);
        
      } else {
        planBadge.className = 'free-badge';
        planBadge.innerHTML = '<i class="fas fa-user"></i>Plano Free';
        upgradeBtn.classList.remove('hidden');
        trialInfo.classList.add('hidden');
      }
    } 
   
    async function checkAuth() {
      const token = localStorage.getItem('geminii_token');
      const userData = localStorage.getItem('geminii_user');

      if (!token || !userData) {
        window.location.href = '/login.html';
        return;
      }

      try {
        const response = await fetch('/auth/verify', {
          headers: { 
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          }
        });

        const result = await response.json();
        
        if (result.success && result.data && result.data.user) {
          userToken = token;
          currentUser = result.data.user;
          
          const plan = checkUserPlan(currentUser);
          updatePlanInterface(plan, currentUser);
          updateUserInterface(currentUser);
          applyAccessControls(); // ✅ AQUI — sem setTimeout
          
          localStorage.setItem('geminii_user', JSON.stringify(currentUser));
        } else {
          localStorage.removeItem('geminii_token');
          localStorage.removeItem('geminii_user');
          window.location.href = '/login.html';
        }
      } catch (error) {
        console.error('Erro na verificação:', error);
        try {
          const user = JSON.parse(userData);
          currentUser = user;
          userToken = token;
          const plan = checkUserPlan(user);
          updatePlanInterface(plan, user);
          updateUserInterface(user);
          applyAccessControls(); // ✅ AQUI também — fallback do localStorage
        } catch (e) {
          window.location.href = '/login.html';
        }
      }
    }

    function updateUserInterface(user) {
      if (!user) return;

      const userInitialsEl = document.getElementById('userInitials');
      const userNameEl = document.getElementById('userName');
      const userEmailEl = document.getElementById('userEmail');
      const memberSinceEl = document.getElementById('memberSince');

      if (user.name) {
        const initials = user.name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
        if (userInitialsEl) userInitialsEl.textContent = initials;
        if (userNameEl) userNameEl.textContent = user.name;
      }

      if (user.email && userEmailEl) {
        userEmailEl.textContent = user.email;
      }

      if (user.created_at && memberSinceEl) {
        const createdDate = new Date(user.created_at).toLocaleDateString('pt-BR');
        memberSinceEl.textContent = createdDate;
      }
    }

    async function loadFreeRecommendationsStatsWithRetry(attempt = 1) {
      if (!userToken) return;

      try {
        // 1. Buscar stats consolidadas do endpoint dedicado (leve, SQL otimizado)
        const statsResponse = await fetch('/api/recommendations/free/dashboard-stats', {
          headers: {
            'Authorization': `Bearer ${userToken}`,
            'Content-Type': 'application/json'
          }
        });

        if (statsResponse.ok) {
          const statsResult = await statsResponse.json();
          if (statsResult.success && statsResult.stats) {
            const s = statsResult.stats;

            const activeSignalsEl = document.getElementById('activeSignalsCount');
            const successRateEl   = document.getElementById('freeSuccessRate');

            if (activeSignalsEl) activeSignalsEl.textContent = s.active_count ?? '--';
            if (successRateEl)   successRateEl.textContent   = s.success_rate > 0 ? `${s.success_rate.toFixed(1)}%` : '--';
          }
        }

        // 2. Buscar ativo recomendado mais recente
        const activeResponse = await fetch('/api/recommendations/free/active', {
          headers: {
            'Authorization': `Bearer ${userToken}`,
            'Content-Type': 'application/json'
          }
        });

        if (activeResponse.ok) {
          const activeResult = await activeResponse.json();
          const recs = activeResult.recommendations || [];
          const tickerEl   = document.getElementById('activeTickerName');
          const companyEl  = document.getElementById('activeTickerCompany');

          if (recs.length > 0) {
            const latest = recs[0]; // já vem ORDER BY created_at DESC
            if (tickerEl)  tickerEl.textContent  = latest.ticker ?? '--';
            if (companyEl) companyEl.textContent  = latest.company_name ?? 'Última recomendação ativa';
          } else {
            if (tickerEl)  tickerEl.textContent  = '--';
            if (companyEl) companyEl.textContent  = 'Nenhuma ativa no momento';
          }
        }

      } catch (error) {
        console.error('Erro ao carregar recomendações:', error);
        setDefaultRecommendationValues();
      }
    }

    function setDefaultRecommendationValues() {
      const activeSignalsEl = document.getElementById('activeSignalsCount');
      const successRateEl   = document.getElementById('freeSuccessRate');
      const tickerEl        = document.getElementById('activeTickerName');
      const companyEl       = document.getElementById('activeTickerCompany');

      if (activeSignalsEl) activeSignalsEl.textContent = '--';
      if (successRateEl)   successRateEl.textContent   = '--';
      if (tickerEl)        tickerEl.textContent        = '--';
      if (companyEl)       companyEl.textContent       = 'Última recomendação ativa';
    }

    function closeOtherDropdowns(except) {
      const allDropdowns = ['mlDropdown', 'opcoesDropdown', 'gratisDropdown', 'opcoes4dDropdown', 'rastreamentoDropdown'];
      const allChevrons = ['mlChevron', 'opcoesChevron', 'gratisChevron', 'opcoes4dChevron', 'rastreamentoChevron'];
      
      allDropdowns.forEach((dropdownId, index) => {
        if (!except.includes(dropdownId)) {
          const dropdown = document.getElementById(dropdownId);
          const chevron = document.getElementById(allChevrons[index]);
          
          if (dropdown && dropdown.classList.contains('show')) {
            dropdown.classList.remove('show');
            if (chevron) chevron.style.transform = 'rotate(0deg)';
          }
        }
      });
    }

    function toggleGratisDropdown() {
      console.log('🎁 Abrindo Gratis Dropdown');
      const dropdown = document.getElementById('gratisDropdown');
      const chevron = document.getElementById('gratisChevron');
      
      closeOtherDropdowns(['gratisDropdown']);
      
      if (dropdown && chevron) {
        if (dropdown.classList.contains('show')) {
          dropdown.classList.remove('show');
          chevron.style.transform = 'rotate(0deg)';
        } else {
          dropdown.classList.add('show');
          chevron.style.transform = 'rotate(180deg)';
        }
      }
    }

    function toggleMLDropdown() {
      if (userPlan === 'free') {
        alert('🔒 Este recurso está disponível apenas para assinantes da Comunidade!\n\nFaça upgrade para acessar todas as ferramentas.');
        return;
      }
      
      console.log('🧠 Abrindo ML Dropdown - user_type:', userPlan);
      
      const dropdown = document.getElementById('mlDropdown');
      const chevron = document.getElementById('mlChevron');
      
      closeOtherDropdowns(['mlDropdown']);
      
      if (dropdown && chevron) {
        if (dropdown.classList.contains('show')) {
          dropdown.classList.remove('show');
          chevron.style.transform = 'rotate(0deg)';
        } else {
          dropdown.classList.add('show');
          chevron.style.transform = 'rotate(180deg)';
        }
      }
    }

    function setupNetflixNavigation() {
      const videoRow = document.getElementById('videoRow');
      const videoNavLeft = document.getElementById('videoNavLeft');
      const videoNavRight = document.getElementById('videoNavRight');
      
      if (videoNavLeft) {
        videoNavLeft.addEventListener('click', () => {
          videoRow.scrollBy({ left: -300, behavior: 'smooth' });
        });
      }
      
      if (videoNavRight) {
        videoNavRight.addEventListener('click', () => {
          videoRow.scrollBy({ left: 300, behavior: 'smooth' });
        });
      }
    }

    // AJUSTE 4: DOMContentLoaded sem chamar updateVideoThumbnails (função não existe neste arquivo)
    document.addEventListener('DOMContentLoaded', () => {
      setupNetflixNavigation();
    });

    function toggleOpcoesDropdown() {
      if (userPlan === 'free') {
        alert('🔒 Este recurso está disponível apenas para assinantes da Comunidade!\n\nFaça upgrade para acessar todas as ferramentas.');
        return;
      }
      
      console.log('📊 Abrindo Opcoes Dropdown - user_type:', userPlan);
      
      const dropdown = document.getElementById('opcoesDropdown');
      const chevron = document.getElementById('opcoesChevron');
      
      closeOtherDropdowns(['opcoesDropdown']);
      
      if (dropdown && chevron) {
        if (dropdown.classList.contains('show')) {
          dropdown.classList.remove('show');
          chevron.style.transform = 'rotate(0deg)';
        } else {
          dropdown.classList.add('show');
          chevron.style.transform = 'rotate(180deg)';
        }
      }
    }

    function toggleOpcoes4dDropdown() {
      if (userPlan === 'free') {
        alert('🔒 Este recurso está disponível apenas para assinantes da Comunidade!\n\nFaça upgrade para acessar todas as ferramentas.');
        return;
      }
      
      console.log('🎲 Abrindo Opcoes4d Dropdown - user_type:', userPlan);
      
      const dropdown = document.getElementById('opcoes4dDropdown');
      const chevron = document.getElementById('opcoes4dChevron');
      
      closeOtherDropdowns(['opcoes4dDropdown']);
      
      if (dropdown && chevron) {
        if (dropdown.classList.contains('show')) {
          dropdown.classList.remove('show');
          chevron.style.transform = 'rotate(0deg)';
        } else {
          dropdown.classList.add('show');
          chevron.style.transform = 'rotate(180deg)';
        }
      }
    }

    async function logout() {
      try {
        if (userToken) {
          await fetch('/auth/logout', {
            method: 'POST',
            headers: { 'Authorization': `Bearer ${userToken}` }
          });
        }
      } catch (error) {
        console.error('Erro no logout:', error);
      } finally {
        localStorage.removeItem('geminii_token');
        localStorage.removeItem('geminii_user');
        window.location.href = '/';
      }
    }

    async function checkApiStatus() {
      if (!userToken) return;
      
      try {
        const response = await fetch('/auth/verify', {
          headers: { 'Authorization': `Bearer ${userToken}` }
        });
        
        const statusEl = document.getElementById('statusIndicator');
        if (statusEl) {
          if (response.ok) {
            statusEl.innerHTML = `
              <div class="w-2 h-2 bg-success rounded-full animate-pulse"></div>
              <span class="text-sm text-gray-300">Online</span>
            `;
          } else {
            statusEl.innerHTML = `
              <div class="w-2 h-2 bg-danger rounded-full animate-pulse"></div>
              <span class="text-sm text-gray-300">Offline</span>
            `;
          }
        }
      } catch (error) {
        const statusEl = document.getElementById('statusIndicator');
        if (statusEl) {
          statusEl.innerHTML = `
            <div class="w-2 h-2 bg-danger rounded-full animate-pulse"></div>
            <span class="text-sm text-gray-300">Offline</span>
          `;
        }
      }
    }

    function toggleRastreamentoDropdown() {
      if (userPlan === 'free') {
        alert('🔒 Este recurso está disponível apenas para assinantes da Comunidade!\n\nFaça upgrade para acessar todas as ferramentas.');
        return;
      }
      
      console.log('📡 Abrindo Rastreamento Dropdown - user_type:', userPlan);
      
      const dropdown = document.getElementById('rastreamentoDropdown');
      const chevron = document.getElementById('rastreamentoChevron');
      
      closeOtherDropdowns(['rastreamentoDropdown']);
      
      if (dropdown && chevron) {
        if (dropdown.classList.contains('show')) {
          dropdown.classList.remove('show');
          chevron.style.transform = 'rotate(0deg)';
        } else {
          dropdown.classList.add('show');
          chevron.style.transform = 'rotate(180deg)';
        }
      }
    }

    window.toggleRastreamentoDropdown = toggleRastreamentoDropdown;
    window.logout = logout;
    window.toggleMLDropdown = toggleMLDropdown;
    window.toggleOpcoesDropdown = toggleOpcoesDropdown;
    window.toggleGratisDropdown = toggleGratisDropdown;
    window.toggleOpcoes4dDropdown = toggleOpcoes4dDropdown;

    function scrollToTools() {
      const toolsSection = document.querySelector('.card.rounded-2xl.p-8.mb-8[style*="z-index: 100"]');
      if (toolsSection) {
        toolsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    function toggleSidebarAccordion(id) {
      const submenu = document.getElementById(id);
      const chevron = document.getElementById('chev-' + id);
      const btn = submenu ? submenu.previousElementSibling : null;

      if (!submenu) return;

      const isOpen = !submenu.classList.contains('hidden');

      // Fecha todos
      document.querySelectorAll('.sb-submenu').forEach(el => el.classList.add('hidden'));
      document.querySelectorAll('.sb-chevron').forEach(el => el.classList.remove('rotated'));
      document.querySelectorAll('.sidebar-accordion > button').forEach(el => el.classList.remove('active-accordion'));

      // Abre o clicado se estava fechado
      if (!isOpen) {
        submenu.classList.remove('hidden');
        if (chevron) chevron.classList.add('rotated');
        if (btn) btn.classList.add('active-accordion');
      }
    }

    window.toggleSidebarAccordion = toggleSidebarAccordion;
    window.scrollToTools = scrollToTools;

    // ── Saudação dinâmica ──────────────────────────────────────
    function setGreeting() {
      const h = new Date().getHours();
      const el = document.getElementById('greetingText');
      if (!el) return;
      if (h >= 5  && h < 12) el.textContent = '☀️ Bom dia!';
      else if (h >= 12 && h < 18) el.textContent = '🌤️ Boa tarde!';
      else el.textContent = '🌙 Boa noite!';
    }
    setGreeting();

    // ── Carousel ───────────────────────────────────────────────
    let currentSlide = 0;
    const totalSlides = 2;
    let carouselTimer = null;

    function goToSlide(index) {
      currentSlide = index;
      const track = document.getElementById('carouselTrack');
      if (track) track.style.transform = `translateX(-${currentSlide * 100}%)`;
      document.querySelectorAll('.carousel-dot').forEach((d, i) => {
        d.style.background = i === currentSlide ? '#fb1ebb' : 'rgba(255,255,255,0.25)';
        d.style.width = i === currentSlide ? '22px' : '8px';
      });
    }

    function nextSlide() {
      goToSlide((currentSlide + 1) % totalSlides);
      resetCarouselTimer();
    }

    function prevSlide() {
      goToSlide((currentSlide - 1 + totalSlides) % totalSlides);
      resetCarouselTimer();
    }

    function resetCarouselTimer() {
      clearInterval(carouselTimer);
      carouselTimer = setInterval(nextSlide, 10000);
    }

    // Auto-play com pause no hover
    const carousel = document.getElementById('mentoriaCarousel');
    if (carousel) {
      resetCarouselTimer();
      carousel.addEventListener('mouseenter', () => clearInterval(carouselTimer));
      carousel.addEventListener('mouseleave', resetCarouselTimer);
    }

    window.goToSlide  = goToSlide;
    window.nextSlide  = nextSlide;
    window.prevSlide  = prevSlide;

    // Hamburger — mobile
    function toggleSidebar() {
      const sidebar = document.getElementById('mainSidebar');
      const overlay = document.getElementById('sidebarOverlay');
      sidebar.classList.toggle('open');
      overlay.classList.toggle('show');
    }

    function closeSidebar() {
      const sidebar = document.getElementById('mainSidebar');
      const overlay = document.getElementById('sidebarOverlay');
      sidebar.classList.remove('open');
      overlay.classList.remove('show');
    }

    window.toggleSidebar = toggleSidebar;
    window.closeSidebar = closeSidebar;

    document.addEventListener('DOMContentLoaded', initDashboard);
  </script>
  
</body>
</html>