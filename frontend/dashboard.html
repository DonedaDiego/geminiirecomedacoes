<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Geminii Tech</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#6366f1',
            secondary: '#8b5cf6',
            accent: '#06b6d4',
            success: '#10b981',
            warning: '#f59e0b',
            danger: '#ef4444',
            geminii: '#ba39af'
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif']
          }
        }
      }
    }
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      scroll-behavior: smooth;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      background: #0f0f0f;
    }
    
    .card {
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
      border-color: rgba(255, 255, 255, 0.2);
    }
    
    .ml-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(15, 15, 15, 0.98);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 12px;
      margin-top: 8px;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s ease;
      z-index: 50;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
    }
    
    .ml-dropdown.show {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }
    
    .ml-card {
      background: linear-gradient(135deg, rgba(138, 43, 226, 0.1), rgba(147, 51, 234, 0.05));
      border: 1px solid rgba(138, 43, 226, 0.2);
      backdrop-filter: blur(20px);
      transition: all 0.3s ease;
    }
    
    .ml-card:hover {
      background: linear-gradient(135degce, rgba(138, 43, 226, 0.15), rgba(147, 51, 234, 0.08));
      border-color: rgba(138, 43, 226, 0.3);
      transform: translateY(-2px);
    }
    
    .stat-card {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.8));
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .navbar {
      background: rgba(15, 15, 15, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .gradient-text {
      background: linear-gradient(135deg, #6366f1, #8b5cf6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #6366f1, #8b5cf6);
      border: none;
      color: white;
      transition: all 0.3s ease;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);
    }
    
    .nav-active {
      color: #6366f1;
      font-weight: 600;
      border-bottom: 2px solid #6366f1;
      padding-bottom: 4px;
    }
    
    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .pulse-glow {
      animation: pulseGlow 2s ease-in-out infinite alternate;
    }
    
    @keyframes pulseGlow {
      from { box-shadow: 0 0 20px rgba(138, 43, 226, 0.3); }
      to { box-shadow: 0 0 30px rgba(138, 43, 226, 0.6); }
    }
  </style>
</head>
<body class="min-h-screen">
  
  <!-- Navigation -->
  <nav class="navbar fixed top-0 left-0 right-0 z-50 px-6 py-4">
    <div class="max-w-7xl mx-auto flex items-center justify-between">
      <div class="flex items-center space-x-8">
        <div class="flex items-center space-x-3">
          <img src="assets/logo.png" alt="Geminii Logo" class="w-8 h-8 rounded-lg" onerror="this.src='/assets/logo.png'; this.onerror=null;">
          <span class="text-xl font-bold text-white">Geminii</span>
        </div>
        <div class="hidden md:flex items-center space-x-6">
          <a href="dashboard.html" class="nav-active transition-colors font-medium">Dashboard</a>
          <!-- <a href="analises.html" class="text-gray-300 hover:text-primary transition-colors">Smart Carteiras</a> -->
          <!-- <a href="swing-trade-machine-learning.html" class="text-gray-300 hover:text-primary transition-colors">Machine Learning</a> -->
        </div>
      </div>
  
      <div class="flex items-center space-x-4">
        <div id="statusIndicator" class="flex items-center space-x-2">
          <div class="w-2 h-2 bg-success rounded-full animate-pulse"></div>
          <span class="text-sm text-gray-300">Online</span>
        </div>
        <button onclick="logout()" class="bg-red-50 hover:bg-red-100 text-red-600 px-4 py-2 rounded-lg text-sm font-medium transition-colors">
          Sair
        </button>
      </div>
    </div>
  </nav>
  

  <!-- Main Content -->
  <main class="pt-20 px-6 pb-12">
    <div class="max-w-7xl mx-auto">
      
      <!-- Header Section -->
      <div class="card rounded-2xl p-8 mb-8 fade-in">
        <div class="flex flex-col lg:flex-row items-center gap-8">
          <div class="flex-shrink-0">
            <div id="userAvatar" class="w-20 h-20 rounded-full bg-gradient-to-r from-primary to-secondary flex items-center justify-center text-white text-xl font-bold shadow-lg">
              <span id="userInitials">U</span>
            </div>
          </div>
          
          <div class="flex-1 text-center lg:text-left">
            <h1 class="text-4xl font-bold text-white mb-2">
              Ol√°, <span id="userName" class="gradient-text">Usu√°rio</span>!
            </h1>
            <p class="text-gray-300 text-lg mb-4" id="userEmail">Bem-vindo ao seu painel de investimentos</p>
            
            <div class="flex flex-col sm:flex-row items-center gap-4">
              <div class="flex items-center gap-2">
                <span class="text-gray-400">Plano:</span>
                <span id="userPlanBadge" class="px-3 py-1 rounded-full text-sm font-semibold bg-gray-100 text-gray-700">B√°sico</span>
              </div>
              <div class="text-sm text-gray-400">
                <i class="fas fa-calendar mr-2"></i>
                Membro desde: <span id="memberSince">2025</span>
              </div>
            </div>
          </div>
          
          <div class="flex flex-col gap-3">
            <a href="planos.html" class="btn-primary px-6 py-3 rounded-xl font-semibold inline-block text-center">
              <i class="fas fa-crown mr-2"></i>Fazer Upgrade
            </a>
            <!-- <button class="bg-gray-700 hover:bg-gray-600 text-gray-200 px-6 py-3 rounded-xl font-semibold transition-colors">
              <i class="fas fa-cog mr-2"></i>Configura√ß√µes
            </button> -->
          </div>
        </div>
      </div>

      <!-- Stats Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div class="stat-card rounded-xl p-6 fade-in">
          <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center">
              <i class="fas fa-chart-line text-primary text-xl"></i>
            </div>
            <div class="text-right">
              <div id="totalPortfolios" class="text-2xl font-bold text-gray-800">0</div>
              <div class="text-sm text-gray-600">Carteiras</div>
            </div>
          </div>
          <div class="text-sm text-primary flex items-center">
            <i class="fas fa-briefcase mr-1"></i>
            <span id="portfoliosText">Dispon√≠veis</span>
          </div>
        </div>

        <div class="stat-card rounded-xl p-6 fade-in">
          <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-success/10 rounded-lg flex items-center justify-center">
              <i class="fas fa-trending-up text-success text-xl"></i>
            </div>
            <div class="text-right">
              <div id="totalRecommendations" class="text-2xl font-bold text-success">0</div>
              <div class="text-sm text-gray-600">Recomenda√ß√µes</div>
            </div>
          </div>
          <div class="text-sm text-success flex items-center">
            <i class="fas fa-lightbulb mr-1"></i>
            <span id="recommendationsText">Ativas</span>
          </div>
        </div>

        <div class="stat-card rounded-xl p-6 fade-in">
          <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-warning/10 rounded-lg flex items-center justify-center">
              <i class="fas fa-percentage text-warning text-xl"></i>
            </div>
            <div class="text-right">
              <div id="portfolioPerformance" class="text-2xl font-bold text-warning">0%</div>
              <div class="text-sm text-gray-600">Performance</div>
            </div>
          </div>
          <div class="text-sm text-warning flex items-center">
            <i class="fas fa-chart-line mr-1"></i>
            <span id="performanceText">M√©dia geral</span>
          </div>
        </div>

        <div class="stat-card rounded-xl p-6 fade-in">
          <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-accent/10 rounded-lg flex items-center justify-center">
              <i class="fas fa-clock text-accent text-xl"></i>
            </div>
            <div class="text-right">
              <div id="lastUpdate" class="text-2xl font-bold text-accent">Traders Free</div>
              <div class="text-sm text-gray-600">Recomenda√ß√µes Quinzenais</div>
            </div>
          </div>
          <div class="text-sm text-accent flex items-center">
            <i class="fas fa-sync mr-1"></i>
            <span>Tempo real</span>
          </div>
        </div>
      </div>

      <!-- Machine Learning Highlight Card -->
      <div class="ml-card rounded-2xl p-8 mb-8 fade-in pulse-glow relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-r from-purple-600/5 to-pink-600/5"></div>
        <div class="relative z-10">
          <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-4">
              <div class="w-16 h-16 bg-gradient-to-r from-purple-600 to-pink-600 rounded-xl flex items-center justify-center">
                <i class="fas fa-brain text-white text-2xl"></i>
              </div>
              <div>
                <h2 class="text-3xl font-bold text-white mb-2">Intelig√™ncia Artificial</h2>
                <p class="text-gray-300">Algoritmos avan√ßados para maximizar seus resultados</p>
              </div>
            </div>
            <div class="text-right">
              <div class="text-purple-400 text-sm font-semibold mb-1">POWERED BY</div>
              <div class="text-2xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">
                Machine Learning
              </div>
            </div>
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <div class="bg-white/5 rounded-lg p-4 border border-white/10">
              <div class="flex items-center gap-3 mb-2">
                <i class="fas fa-chart-line text-green-400"></i>
                <span class="text-white font-semibold">Swing Trade ML</span>
              </div>
              <p class="text-gray-400 text-sm">IA Preditiva com Stops Din√¢micos</p>
            </div>

            <div class="bg-white/5 rounded-lg p-4 border border-white/10">
              <div class="flex items-center gap-3 mb-2">
                <i class="fas fa-robot text-blue-400"></i>
                <span class="text-white font-semibold">Beta Regression</span>
              </div>
              <p class="text-gray-400 text-sm">Regress√£o Avan√ßada vs IBOVESPA</p>
            </div>

            <div class="bg-white/5 rounded-lg p-4 border border-white/10">
              <div class="flex items-center gap-3 mb-2">
                <i class="fas fa-rocket text-purple-400"></i>
                <span class="text-white font-semibold">ATSMOM</span>
              </div>
              <p class="text-gray-400 text-sm">Adaptive Time Series Momentum</p>
            </div>

            <div class="bg-white/5 rounded-lg p-4 border border-white/10">
              <div class="flex items-center gap-3 mb-2">
                <i class="fas fa-eye text-orange-400"></i>
                <span class="text-white font-semibold">Pattern Recognition</span>
              </div>
              <p class="text-gray-400 text-sm">Reconhecimento de Padr√µes</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Recommendations Free Card -->
      <div class="card rounded-2xl p-8 mb-8 fade-in relative overflow-hidden">
        <div class="absolute top-0 right-0 bg-gradient-to-l from-geminii/20 to-transparent w-64 h-64 -mr-32 -mt-32 rounded-full blur-3xl"></div>
        <div class="relative z-10">
          <div class="flex items-center justify-between mb-6">
            <div>
              <h2 class="text-2xl font-bold text-white mb-2 flex items-center">
                <i class="fas fa-gift text-geminii mr-3"></i>
                Recomenda√ß√µes Free Mensais
              </h2>
              <p class="text-gray-300">An√°lises profissionais geradas por Machine Learning</p>
            </div>
            <a href="recomendacoes-free.html" class="btn-primary px-6 py-3 rounded-xl font-semibold inline-flex items-center">
              <i class="fas fa-chart-line mr-2"></i>
              Ver Recomenda√ß√µes
            </a>
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-white/5 rounded-lg p-4">
              <div class="flex items-center justify-between mb-2">
                <span class="text-gray-400">Sinais Ativos</span>
                <i class="fas fa-signal text-accent"></i>
              </div>
              <div class="text-2xl font-bold text-white" id="activeSignalsCount">--</div>
              <div class="text-sm text-gray-400">Atualizados em tempo real</div>
            </div>
            
            <div class="bg-white/5 rounded-lg p-4">
              <div class="flex items-center justify-between mb-2">
                <span class="text-gray-400">Taxa de Acerto</span>
                <i class="fas fa-bullseye text-success"></i>
              </div>
              <div class="text-2xl font-bold text-success" id="freeSuccessRate">--</div>
              <div class="text-sm text-gray-400">√öltimos 30 dias</div>
            </div>
            
            <div class="bg-white/5 rounded-lg p-4">
              <div class="flex items-center justify-between mb-2">
                <span class="text-gray-400">Pr√≥xima Atualiza√ß√£o</span>
                <i class="fas fa-calendar text-warning"></i>
              </div>
              <div class="text-2xl font-bold text-white" id="nextUpdateDays">--</div>
              <div class="text-sm text-gray-400">Mensal</div>
            </div>
          </div>
          
          <div class="mt-6 p-4 bg-geminii/10 border border-geminii/30 rounded-lg">
            <div class="flex items-center">
              <i class="fas fa-info-circle text-geminii mr-3"></i>
              <p class="text-sm text-gray-300">
                <span class="font-semibold text-white">100% Gr√°tis:</span> 
                Nossos modelos de ML analisam o mercado e geram at√© 5 recomenda√ß√µes mensais com entrada, alvo e stop loss definidos.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="card rounded-2xl p-8 mb-8 fade-in">
        <h2 class="text-2xl font-bold text-white mb-6 flex items-center">
          <i class="fas fa-bolt text-primary mr-3"></i>
          A√ß√µes R√°pidas
        </h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          
          <!-- GR√ÅTIS -->
          <a href="monitor-basico.html" class="relative bg-gradient-to-r from-success/10 to-success/5 hover:from-success/20 hover:to-success/10 border border-success/20 rounded-xl p-6 transition-all group">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 bg-success/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform">
                <i class="fas fa-chart-area text-success text-lg"></i>
              </div>
              <div>
                <h3 class="font-semibold text-white">Monitor Beta</h3>
                <p class="text-sm text-gray-300">An√°lise vs IBOVESPA</p>
              </div>
            </div>
            <span class="absolute top-4 right-4 bg-green-500 text-white text-xs px-2 py-1 rounded-full font-bold">GR√ÅTIS</span>
          </a>

          <a href="rsl.html" class="bg-gradient-to-r from-pink-500/10 to-pink-500/5 hover:from-pink-500/20 hover:to-pink-500/10 border border-pink-500/20 rounded-xl p-6 transition-all group cursor-pointer relative">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 bg-pink-500/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform">
                <i class="fas fa-robot text-pink-400 text-lg"></i>
              </div>
              <div>
                <h3 class="font-semibold text-white">RSL Premium</h3>
                <p class="text-sm text-gray-300">Indicadores IA</p>
              </div>
            </div>
            <span class="absolute top-4 right-4 bg-green-500 text-white text-xs px-2 py-1 rounded-full font-bold">GR√ÅTIS</span>
          </a>

          <!-- PLANO PRO -->
          <div onclick="showPremiumFeature('Long & Short')" class="bg-gradient-to-r from-secondary/10 to-secondary/5 hover:from-secondary/20 hover:to-secondary/10 border border-secondary/20 rounded-xl p-6 transition-all group cursor-pointer relative">
            <div class="flex items-center gap-4">
              <div class="bg-gradient-to-r from-primary/10 to-primary/5 hover:from-primary/20 hover:to-primary/10 border border-primary/20 rounded-xl p-6 transition-all group cursor-pointer relative">
                <i class="fas fa-exchange-alt text-secondary text-lg"></i>
              </div>
              <div>
                <h3 class="font-semibold text-white">Long & Short</h3>
                <p class="text-sm text-gray-300">Cointegra√ß√£o</p>
              </div>
            </div>
            <span class="absolute top-4 right-4 bg-warning text-white text-xs px-2 py-1 rounded-full font-bold">PRO</span>
          </div>

          <div onclick="showPremiumFeature('Hunter Walls')" class="bg-gradient-to-r from-orange-500/10 to-orange-500/5 hover:from-orange-500/20 hover:to-orange-500/10 border border-orange-500/20 rounded-xl p-6 transition-all group cursor-pointer relative">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 bg-orange-500/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform">
                <i class="fas fa-crosshairs text-orange-400 text-lg"></i>
              </div>
              <div>
                <h3 class="font-semibold text-white">Hunter Walls</h3>
                <p class="text-sm text-gray-300">An√°lise de Op√ß√µes</p>
              </div>
            </div>
            <span class="absolute top-4 right-4 bg-warning text-white text-xs px-2 py-1 rounded-full font-bold">PRO</span>
          </div>

          <!-- PLANO PREMIUM (ESTRAT√âGICO) -->
          <div onclick="showPremiumFeature('Smart Carteiras')" class="bg-gradient-to-r from-primary/10 to-primary/5 hover:from-primary/20 hover:to-primary/10 border border-primary/20 rounded-xl p-6 transition-all group cursor-pointer relative">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 bg-primary/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform">
                <i class="fa-solid fa-square-poll-vertical fa-beat-fade" style="color: #B197FC;"></i>
              </div>
              <div>
                <h3 class="font-semibold text-white">Smart Carteiras</h3>
                <p class="text-sm text-gray-300">An√°lises especializadas com Machine Learning</p>
              </div>
            </div>
            <span class="absolute top-4 right-4 bg-secondary text-white text-xs px-2 py-1 rounded-full font-bold">PREMIUM</span>
          </div>

          <!-- Machine Learning com Submenu -->
          <div class="relative">
            <div 
              onclick="showPremiumFeature('Machine Learning')"
              class="bg-gradient-to-r from-purple-500/10 to-purple-500/5 hover:from-purple-500/20 hover:to-purple-500/10 border border-purple-500/20 rounded-xl p-6 transition-all group cursor-pointer relative"
            >
              <div class="flex items-center gap-4">
                <div class="bg-gradient-to-r from-primary/10 to-primary/5 hover:from-primary/20 hover:to-primary/10 border border-primary/20 rounded-xl p-6 transition-all group cursor-pointer relative">
                  <i class="fas fa-brain text-purple-400 text-lg"></i>
                </div>
                <div class="flex-1">
                  <h3 class="font-semibold text-white">Machine Learning</h3>
                  <p class="text-sm text-gray-300">IA Preditiva + Algoritmos</p>
                </div>
                <i class="fas fa-chevron-down text-gray-400 transition-transform duration-300" id="mlChevron"></i>
              </div>
              <span class="absolute top-4 right-4 bg-purple-600 text-white text-xs px-2 py-1 rounded-full font-bold">PREMIUM</span>
            </div>
            
            <!-- Submenu Dropdown -->
            <div id="mlDropdown" class="ml-dropdown">
              <div class="grid grid-cols-1 gap-2">
                <a href="swing-trade-machine-learning.html" class="flex items-center gap-3 p-3 rounded-lg hover:bg-white/5 transition-colors text-white">
                  <i class="fas fa-chart-line text-green-400 w-5"></i>
                  <div>
                    <div class="font-medium">Swing Trade ML</div>
                    <div class="text-xs text-gray-400">IA Preditiva com Stops Din√¢micos</div>
                  </div>
                </a>
                
                <a href="beta-regression.html" class="flex items-center gap-3 p-3 rounded-lg hover:bg-white/5 transition-colors text-white">
                  <i class="fas fa-calculator text-blue-400 w-5"></i>
                  <div>
                    <div class="font-medium">Beta Regression</div>
                    <div class="text-xs text-gray-400">Regress√£o vs IBOVESPA</div>
                  </div>
                </a>
                
                <a href="atsmom.html" class="flex items-center gap-3 p-3 rounded-lg hover:bg-white/5 transition-colors text-white">
                  <i class="fas fa-rocket text-purple-400 w-5"></i>
                  <div>
                    <div class="font-medium">ATSMOM</div>
                    <div class="text-xs text-gray-400">Adaptive Time Series Momentum</div>
                  </div>
                </a>
                
                <div onclick="showPremiumFeature('Pattern Recognition')" class="flex items-center gap-3 p-3 rounded-lg hover:bg-white/5 transition-colors text-white cursor-pointer">
                  <i class="fas fa-eye text-orange-400 w-5"></i>
                  <div class="flex-1">
                    <div class="font-medium">Pattern Recognition</div>
                    <div class="text-xs text-gray-400">Reconhecimento de Padr√µes Avan√ßado</div>
                  </div>
                  <span class="bg-red-600 text-white text-xs px-2 py-1 rounded-full font-bold">EM BREVE</span>
                </div>
                
                <div onclick="showPremiumFeature('AutoML')" class="flex items-center gap-3 p-3 rounded-lg hover:bg-white/5 transition-colors text-white cursor-pointer">
                  <i class="fas fa-magic text-pink-400 w-5"></i>
                  <div class="flex-1">
                    <div class="font-medium">AutoML</div>
                    <div class="text-xs text-gray-400">Machine Learning Automatizado</div>
                  </div>
                  <span class="bg-red-600 text-white text-xs px-2 py-1 rounded-full font-bold">EM BREVE</span>
                </div>
              </div>
            </div>
          </div>

          <!-- <a href="planos.html" class="bg-gradient-to-r from-primary to-secondary text-white rounded-xl p-6 transition-all group hover:shadow-lg">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform">
                <i class="fas fa-crown text-white text-lg"></i>
              </div>
              <div>
                <h3 class="font-semibold">Fazer Upgrade</h3>
                <p class="text-sm opacity-90">Todos os recursos</p>
              </div>
            </div>
          </a>
        </div>
      </div> -->

      
    </div>
  </main>

  <script>
    let currentUser = null;
    let userToken = null;

    // Initialize dashboard
    // Initialize dashboard
    async function initDashboard() {
      console.log('üöÄ Inicializando Dashboard Geminii...');
      
      // Tentar carregar dados do localStorage primeiro (fallback)
      tryLoadFromLocalStorage();
      
      await checkAuth();
      await loadUserStats();
      await loadFreeRecommendationsStatsWithRetry(); // ‚¨ÖÔ∏è MUDAN√áA AQUI
      checkApiStatus();
      setInterval(checkApiStatus, 30000);
      
      // Close dropdown when clicking outside
      document.addEventListener('click', function(event) {
        const dropdown = document.getElementById('mlDropdown');
        if (dropdown) {
          const mlCard = event.target.closest('.relative');
          
          if (!mlCard && dropdown.classList.contains('show')) {
            toggleMLDropdown();
          }
        }
      });
      
      console.log('‚úÖ Dashboard inicializado!');
    }

    // Try to load user data from localStorage as fallback
    function tryLoadFromLocalStorage() {
      try {
        const userData = localStorage.getItem('geminii_user');
        if (userData) {
          const user = JSON.parse(userData);
          if (user && user.name) {
            console.log('üì¶ Carregando dados do localStorage como fallback:', user.name);
            updateUserInterface(user);
          }
        }
      } catch (error) {
        console.log('‚ö†Ô∏è Erro ao carregar dados do localStorage:', error);
      }
    }

    // Toggle ML Dropdown
    function toggleMLDropdown() {
      const dropdown = document.getElementById('mlDropdown');
      const chevron = document.getElementById('mlChevron');
      
      if (dropdown && chevron) {
        if (dropdown.classList.contains('show')) {
          dropdown.classList.remove('show');
          chevron.style.transform = 'rotate(0deg)';
        } else {
          dropdown.classList.add('show');
          chevron.style.transform = 'rotate(180deg)';
        }
      }
    }

    // Check authentication
    // Check authentication com retry
    async function checkAuth() {
      const token = localStorage.getItem('geminii_token');
      const userData = localStorage.getItem('geminii_user');

      if (!token || !userData) {
        console.log('‚ùå Token ou userData n√£o encontrados, redirecionando...');
        window.location.href = '/login.html';
        return;
      }

      try {
        console.log('üîç Verificando autentica√ß√£o com o servidor...');
        
        const response = await fetch('/auth/verify', {
          headers: { 
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
          },
          cache: 'no-cache'
        });

        const result = await response.json();
        console.log('üì° Resposta da verifica√ß√£o:', result);

        if (result.success && result.data && result.data.user) {
          userToken = token;
          currentUser = result.data.user;
          
          console.log('‚úÖ Dados do usu√°rio recebidos:', currentUser);
          
          // Atualizar localStorage com dados mais recentes
          localStorage.setItem('geminii_user', JSON.stringify(currentUser));
          
          updateUserInterface(currentUser);
        } else {
          console.log('‚ùå Falha na verifica√ß√£o, limpando dados...');
          localStorage.removeItem('geminii_token');
          localStorage.removeItem('geminii_user');
          window.location.href = '/login.html';
        }
      } catch (error) {
        console.error('‚ùå Erro na verifica√ß√£o de auth:', error);
        
        // Em caso de erro de rede, tentar usar dados do localStorage
        try {
          const userData = localStorage.getItem('geminii_user');
          if (userData) {
            const user = JSON.parse(userData);
            console.log('üîÑ Usando dados do localStorage devido a erro de rede');
            currentUser = user;
            userToken = token;
            updateUserInterface(user);
            return;
          }
        } catch (e) {
          console.error('Erro ao usar dados do localStorage:', e);
        }
        
        // Se n√£o conseguir usar localStorage, redirecionar
        localStorage.removeItem('geminii_token');
        localStorage.removeItem('geminii_user');
        window.location.href = '/login.html';
      }
    }

    // Update user interface
    function updateUserInterface(user) {
      console.log('üé® Atualizando interface do usu√°rio com:', user);
      
      if (!user) {
        console.log('‚ùå Usu√°rio √© null/undefined');
        return;
      }

      // Verificar se os elementos existem antes de atualizar
      const userInitialsEl = document.getElementById('userInitials');
      const userNameEl = document.getElementById('userName');
      const userEmailEl = document.getElementById('userEmail');
      const planBadgeEl = document.getElementById('userPlanBadge');
      const memberSinceEl = document.getElementById('memberSince');

      // Atualizar nome e iniciais
      if (user.name) {
        const initials = user.name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
        
        if (userInitialsEl) {
          userInitialsEl.textContent = initials;
          console.log('‚úÖ Iniciais atualizadas:', initials);
        }
        
        if (userNameEl) {
          userNameEl.textContent = user.name;
          console.log('‚úÖ Nome atualizado:', user.name);
        }
      }

      // Atualizar email
      if (user.email && userEmailEl) {
        userEmailEl.textContent = user.email;
        console.log('‚úÖ Email atualizado:', user.email);
      }

      // Atualizar plano
      if (planBadgeEl) {
        const planId = user.plan_id || 3;
        
        if (planId === 3) {
          planBadgeEl.textContent = 'B√°sico';
          planBadgeEl.className = 'px-3 py-1 rounded-full text-sm font-semibold bg-gray-600 text-gray-200';
        } else if (planId === 1) {
          planBadgeEl.textContent = 'Pro';
          planBadgeEl.className = 'px-3 py-1 rounded-full text-sm font-semibold bg-warning text-white';
        } else if (planId >=2) {
          planBadgeEl.textContent = 'Premium';
          planBadgeEl.className = 'px-3 py-1 rounded-full text-sm font-semibold bg-secondary text-white';
        }
        
        console.log('‚úÖ Plano atualizado:', planId);
      }

      // Atualizar data de cria√ß√£o
      if (user.created_at && memberSinceEl) {
        const createdDate = new Date(user.created_at).toLocaleDateString('pt-BR');
        memberSinceEl.textContent = createdDate;
        console.log('‚úÖ Data de cria√ß√£o atualizada:', createdDate);
      }

      console.log('üéâ Interface do usu√°rio atualizada com sucesso!');
    }

    // Load user statistics
    async function loadUserStats() {
      if (!userToken) {
        console.log('‚ö†Ô∏è Token n√£o dispon√≠vel para carregar estat√≠sticas');
        return;
      }

      try {
        const response = await fetch('/api/user/my-portfolios', {
          headers: { 'Authorization': `Bearer ${userToken}` }
        });

        if (response.ok) {
          const result = await response.json();
          if (result.success) {
            const portfolios = result.portfolios || [];
            
            const totalPortfoliosEl = document.getElementById('totalPortfolios');
            const portfoliosTextEl = document.getElementById('portfoliosText');
            const totalRecommendationsEl = document.getElementById('totalRecommendations');
            const recommendationsTextEl = document.getElementById('recommendationsText');
            
            if (totalPortfoliosEl) {
              totalPortfoliosEl.textContent = portfolios.length;
            }
            
            if (portfoliosTextEl) {
              portfoliosTextEl.textContent = 
                portfolios.length > 0 ? `${portfolios.length} dispon√≠vel${portfolios.length > 1 ? 'is' : ''}` : 'Nenhuma dispon√≠vel';
            }
            
            // Simular outras estat√≠sticas
            if (totalRecommendationsEl) {
              totalRecommendationsEl.textContent = portfolios.length * 3;
            }
            
            if (recommendationsTextEl) {
              recommendationsTextEl.textContent = 'Ativas';
            }
            
            console.log('üìä Estat√≠sticas carregadas:', portfolios.length, 'carteiras');
          }
        }
      } catch (error) {
        console.error('‚ùå Erro ao carregar estat√≠sticas:', error);
      }
    }

    // Load Free Recommendations Stats com retry
    async function loadFreeRecommendationsStatsWithRetry(attempt = 1) {
      if (!userToken) {
        console.log('‚ö†Ô∏è Token n√£o dispon√≠vel para carregar recomenda√ß√µes');
        return;
      }

      try {
        console.log(`üì° Carregando estat√≠sticas das recomenda√ß√µes free (tentativa ${attempt})...`);
        
        // ‚úÖ MUDAN√áA PRINCIPAL: Usar endpoint p√∫blico (/free/all) ao inv√©s de admin
        const response = await fetch('/api/recommendations/free/all', {
          headers: { 
            'Authorization': `Bearer ${userToken}`,
            'Content-Type': 'application/json'
          },
          cache: 'no-cache'
        });

        console.log('üìä Status da resposta (recomenda√ß√µes):', response.status);

        // Tratamento espec√≠fico para erro 403
        if (response.status === 403) {
          console.log('üö´ Erro 403 nas recomenda√ß√µes - verificando auth...');
          
          // Tentar renovar a autentica√ß√£o
          await checkAuth();
          
          if (attempt < 3) {
            console.log('üîÑ Tentando carregar recomenda√ß√µes novamente...');
            await new Promise(resolve => setTimeout(resolve, 2000));
            return loadFreeRecommendationsStatsWithRetry(attempt + 1);
          }
          
          // Se esgotar tentativas, usar valores padr√£o
          console.log('‚ùå Acesso negado √†s recomenda√ß√µes - usando valores padr√£o');
          setDefaultRecommendationValues();
          return;
        }

        if (response.status === 401) {
          console.log('üîë Token expirado para recomenda√ß√µes');
          setDefaultRecommendationValues();
          return;
        }

        if (response.ok) {
          const result = await response.json();
          if (result.success) {
            const allRecs = result.recommendations || [];
            
            // Filtrar apenas ativas
            const activeRecs = allRecs.filter(r => r.status === 'ATIVA');
            
            // Calcular estat√≠sticas
            const closedRecs = allRecs.filter(r => r.status && r.status.startsWith('FINALIZADA'));
            const wins = closedRecs.filter(r => r.status === 'FINALIZADA_GANHO');
            const successRate = closedRecs.length > 0 ? (wins.length / closedRecs.length * 100) : 0;
            
            // Calcular pr√≥xima atualiza√ß√£o (primeira sexta do pr√≥ximo m√™s)
            const now = new Date();
            const nextMonth = new Date(now.getFullYear(), now.getMonth() + 1, 1);
            const firstFriday = new Date(nextMonth);
            while (firstFriday.getDay() !== 5) {
              firstFriday.setDate(firstFriday.getDate() + 1);
            }
            const daysUntilUpdate = Math.ceil((firstFriday - now) / (1000 * 60 * 60 * 24));
            
            // Atualizar elementos do dashboard
            const activeSignalsEl = document.getElementById('activeSignalsCount');
            const successRateEl = document.getElementById('freeSuccessRate');
            const nextUpdateEl = document.getElementById('nextUpdateDays');
            
            if (activeSignalsEl) {
              activeSignalsEl.textContent = activeRecs.length;
            }
            
            if (successRateEl) {
              successRateEl.textContent = successRate > 0 ? `${successRate.toFixed(1)}%` : '--';
            }
            
            if (nextUpdateEl) {
              nextUpdateEl.textContent = daysUntilUpdate > 0 ? `${daysUntilUpdate} dias` : 'Em breve';
            }
            
            console.log('üìä Estat√≠sticas free carregadas:', {
              ativas: activeRecs.length,
              sucesso: successRate.toFixed(1) + '%',
              proximaAtualizacao: daysUntilUpdate + ' dias'
            });
            
          } else {
            throw new Error(result.error || 'Erro na API');
          }
        } else {
          throw new Error(`HTTP ${response.status}`);
        }
      } catch (error) {
        console.error(`‚ùå Erro ao carregar recomenda√ß√µes free (tentativa ${attempt}):`, error);
        
        if (attempt < 3) {
          console.log(`üîÑ Tentando novamente em 3 segundos...`);
          await new Promise(resolve => setTimeout(resolve, 3000));
          return loadFreeRecommendationsStatsWithRetry(attempt + 1);
        }
        
        // Se esgotar todas as tentativas, usar valores padr√£o
        setDefaultRecommendationValues();
      }
    }
    // Definir valores padr√£o quando n√£o conseguir carregar recomenda√ß√µes
    function setDefaultRecommendationValues() {
      console.log('üìã Definindo valores padr√£o para recomenda√ß√µes...');
      
      const activeSignalsEl = document.getElementById('activeSignalsCount');
      const successRateEl = document.getElementById('freeSuccessRate');
      const nextUpdateEl = document.getElementById('nextUpdateDays');
      
      if (activeSignalsEl) activeSignalsEl.textContent = '--';
      if (successRateEl) successRateEl.textContent = '--';
      if (nextUpdateEl) nextUpdateEl.textContent = '--';
    }

    // Show premium feature dialog
    function showPremiumFeature(featureName) {
      if (!currentUser) {
        console.log('‚ö†Ô∏è Usu√°rio n√£o dispon√≠vel para verificar plano');
        return;
      }
    
      const userPlanId = currentUser.plan_id || 3;
      
      // ‚úÖ NOVA L√ìGICA: Verifica√ß√£o correta por plano espec√≠fico
      let hasAccess = false;
      let requiredPlanName = '';
      
      // Definir acesso baseado no recurso
      if (featureName === 'Long & Short' || featureName === 'Hunter Walls') {
        // Recursos PRO - precisam de plano 1 (Pro) ou 2 (Premium)
        hasAccess = (userPlanId === 1 || userPlanId === 2);
        requiredPlanName = 'Pro';
      }
      
      if (featureName === 'Smart Carteiras' || featureName === 'Machine Learning') {
        // Recursos PREMIUM - precisam apenas de plano 2 (Premium)
        hasAccess = (userPlanId === 2);
        requiredPlanName = 'Premium';
      }
    
      // Se tem acesso, permitir
      if (hasAccess) {
        
        // REDIRECIONAMENTOS CORRETOS
        if (featureName === 'Long & Short') {
          window.location.href = 'long-short.html';
          return;
        }
        
        if (featureName === 'Hunter Walls') {
          window.location.href = 'opcoes.html';
          return;
        }
    
        if (featureName === 'Smart Carteiras') {
          window.location.href = 'analises.html';
          return;
        }
    
        // Machine Learning abre dropdown
        if (featureName === 'Machine Learning') {
          toggleMLDropdown();
          return;
        }
    
        // Recursos EM BREVE
        if (featureName === 'Pattern Recognition') {
          alert(`üëÅÔ∏è Pattern Recognition\n\nReconhecimento de Padr√µes Avan√ßado!\n\nEm breve ser√° implementado.`);
          return;
        }
    
        if (featureName === 'AutoML') {
          alert(`ü™Ñ AutoML\n\nMachine Learning Automatizado!\n\nEm breve ser√° implementado.`);
          return;
        }
                
        // Para outros recursos ainda n√£o implementados
        alert(`üéâ ${featureName}\n\nFuncionalidade dispon√≠vel em seu plano!\nEm breve ser√° implementada.`);
        
      } else {
        // ‚úÖ USU√ÅRIO N√ÉO TEM ACESSO - Mostrar upgrade
        const planNames = { 3: 'B√°sico', 1: 'Pro', 2: 'Premium' };
        const currentPlanName = currentUser.plan_name || planNames[userPlanId] || 'B√°sico';
        
        const message = `üíé Recurso ${requiredPlanName}\n\n${featureName} est√° dispon√≠vel apenas para planos ${requiredPlanName} ou superior.\n\nSeu plano atual: ${currentPlanName}\nPlano necess√°rio: ${requiredPlanName}\n\nDeseja fazer upgrade agora?`;
        
        if (confirm(message)) {
          window.location.href = '/planos.html';
        }
      }
    }

    // Logout function
    async function logout() {
      try {
        if (userToken) {
          await fetch('/auth/logout', {
            method: 'POST',
            headers: { 'Authorization': `Bearer ${userToken}` }
          });
        }
      } catch (error) {
        console.error('Erro no logout:', error);
      } finally {
        localStorage.removeItem('geminii_token');
        localStorage.removeItem('geminii_user');
        console.log('üö™ Logout realizado, redirecionando...');
        window.location.href = '/';
      }
    }

    // Check API status
    async function checkApiStatus() {
      if (!userToken) return;
      
      try {
        const response = await fetch('/auth/verify', {
          headers: { 'Authorization': `Bearer ${userToken}` }
        });
        
        const statusEl = document.getElementById('statusIndicator');
        if (statusEl) {
          if (response.ok) {
            statusEl.innerHTML = `
              <div class="w-2 h-2 bg-success rounded-full animate-pulse"></div>
              <span class="text-sm text-gray-300">Online</span>
            `;
          } else {
            statusEl.innerHTML = `
              <div class="w-2 h-2 bg-danger rounded-full animate-pulse"></div>
              <span class="text-sm text-gray-300">Offline</span>
            `;
          }
        }
      } catch (error) {
        const statusEl = document.getElementById('statusIndicator');
        if (statusEl) {
          statusEl.innerHTML = `
            <div class="w-2 h-2 bg-danger rounded-full animate-pulse"></div>
            <span class="text-sm text-gray-300">Offline</span>
          `;
        }
      }
    }

    // Make functions global
    window.logout = logout;
    window.showPremiumFeature = showPremiumFeature;
    window.toggleMLDropdown = toggleMLDropdown;

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', initDashboard);
</script>
</body>
</html>